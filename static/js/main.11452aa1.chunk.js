(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(3),r=n.n(i),h=(n(14),n(4)),s=n(5),l=n(7),c=n(6),m=n(1),u=n(8),d=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},t.description)},f=function(e){for(var t=e.control,n=[],a=0;a<t.options.length;a++)n.push(o.a.createElement("option",{key:a,value:a},t.options[a]));return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name),o.a.createElement("select",{id:t.name,className:"select-css",value:t.value,onChange:function(n){e.onChange(t,n.target.value)}},n))},v=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{className:"clickable",htmlFor:t.name},o.a.createElement("input",{className:"clickable",id:t.name,type:"checkbox",checked:t.value,onChange:function(n){e.onChange(t,n.target.checked)}}),t.name))},y=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name," ",t.value),o.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:t.min,max:t.max,value:t.value,onChange:function(n){e.onChange(t,Number(n.target.value))}}))},g=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name," ",t.value.toFixed(3)),o.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:Math.floor(1e3*t.min),max:Math.floor(1e3*t.max),value:Math.floor(1e3*t.value),onChange:function(n){e.onChange(t,Number(n.target.value)/1e3)}}))},p=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("button",{onClick:function(e){t.function()}},t.name))},x=function(e){var t,n=e.show,a=e.title,i=e.onClickPrevious,r=e.onClickNext,h=e.onChange,s=e.options;return n?(s&&(t=s.map((function(e,t){switch(e.type){case"description":return o.a.createElement(d,{key:t,control:e});case"select":return o.a.createElement(f,{key:t,control:e,onChange:h});case"bool":return o.a.createElement(v,{key:t,control:e,onChange:h});case"int":return o.a.createElement(y,{key:t,control:e,onChange:h});case"float":return o.a.createElement(g,{key:t,control:e,onChange:h});case"function":return o.a.createElement(p,{key:t,control:e});default:return o.a.createElement("div",{key:t,className:"control"},e.type," is not supported")}}))),o.a.createElement("div",{id:"controls"},o.a.createElement("div",{className:"none"},o.a.createElement("span",{className:"left",onClick:i},"\u276e PREV"),o.a.createElement("span",{className:"right",onClick:r},"NEXT \u276f"),o.a.createElement("div",{className:"center title"},a)),o.a.createElement("div",null,t))):null},w=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];function k(e){for(var t=e.width,n=e.height,a=e.zones,o=e.bossRoom,i=[],r=0;r<n;r++)i.push(new Array(t).fill(0));var h={width:t,height:n,data:i};!function(e,t){var n=e.width,a=e.height,o=t.goal,i=t.minSize,r=t.maxSize;o||(o=.5);i||(i=3);r||(r=Math.max(Math.floor(Math.min(n/4,a/4)),i));for(var h=[],s=0,l=r;l>=i;l--)for(var c=Math.pow(2,s++),m=0;m<c;m++)h.push(l);var u=[],d=n*a*o,f=0;for(;f<d;){var v=C(h),y={width:v,height:v};Math.random()>.3&&(Math.random()<.5?y.width+=2:y.height+=2),u.push(y),f+=y.width*y.height}e.rooms=u}(h,e),h.rooms.sort((function(e,t){var n=e.width*e.height,a=t.width*t.height;return n<a?1:n>a?-1:0}));var s=e.maxRooms;if(a&&a>1){if(function(e,t){for(var n=e.width,a=e.height,o=[],i=0;i<t;i++)o[i]=i;!function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}}(o);for(var r=Math.floor((n-2)/t),h=Math.floor((a-2)/t),s=[],l=0;l<t;l++){var c={x:l*r+1,y:o[l]*h+1,width:r,height:h};s.push(c)}e.zones=s}(h,a),o){var l=h.rooms[0],c=h.zones[0];l.width<=c.width&&l.height<=c.height&&(l.x=Math.floor(c.x),l.y=Math.floor(c.y+(c.height-l.height)/2))}var m=function(e,t){for(var n=e.width,a=e.height,o=e.rooms,i=e.zones,r=0,h=0,s=o.length,l=0;l<s&&(!t||r!==t);l++){var c=o[l];if(!c.hasOwnProperty("x")||!c.hasOwnProperty("y")){var m=i[h].x,u=Math.min(i[h].x+i[h].width,n-c.width-1),d=i[h].y,f=Math.min(i[h].y+i[h].height,a-c.height-1);if(!(m+c.width>n-1||d+c.height>a-1)){for(var v=!1,y=0;y<100;y++){c.x=b(m,u),c.y=b(d,f);for(var g=!1,p=0;p<s;p++)if(p!==l&&o[p].hasOwnProperty("x")&&o[p].hasOwnProperty("y")&&E(c,o[p],1,1)){g=!0;break}if(!g){v=!0;break}}v?(r++,h=(h+1)%i.length):(delete c.x,delete c.y)}}}return r}(h,s);void 0!==s&&(s-=m)}else if(o){var u=h.rooms[0];u.width<=t-2&&u.height<=n-2&&(u.x=Math.floor((t-u.width)/2),u.y=Math.floor((n-u.height)/2))}return function(e,t){for(var n=e.width,a=e.height,o=e.rooms,i=0,r=o.length,h=0;h<r&&(void 0===t||i!==t);h++){var s=o[h];if(!s.hasOwnProperty("x")||!s.hasOwnProperty("y")){for(var l=!1,c=0;c<1e3;c++){s.x=b(1,n-s.width-1),s.y=b(1,a-s.height-1);for(var m=!1,u=0;u<r;u++)if(u!==h&&o[u].hasOwnProperty("x")&&o[u].hasOwnProperty("y")&&E(s,o[u],s.width>=7?3:1,s.height>=7?3:1)){m=!0;break}if(!m){l=!0;break}}l?i++:(delete s.x,delete s.y)}}e.rooms=e.rooms.filter((function(e){return e.x||e.y})),e.rooms.length}(h,s),function(e){for(var t=e.data,n=e.rooms,a=n.length,o=0;o<a;o++){var i=n[o];i.id=o+1;for(var r=0;r<i.height;r++)for(var h=0;h<i.width;h++)t[i.y+r][i.x+h]=i.id}}(h),function(e){var t=e.data,n=e.rooms,a=F(n.length),o=function(e){for(var t=e.width,n=e.height,a=e.data,o=[],i=1;i<n-1;i++)for(var r=1;r<t-1;r++)0===a[i][r]&&(0===a[i-1][r]&&0===a[i+1][r]&&0!==a[i][r-1]&&0!==a[i][r+1]?a[i][r-1]<a[i][r+1]?o.push({x:r,y:i,r1:a[i][r-1],r2:a[i][r+1]}):a[i][r-1]>a[i][r+1]&&o.push({x:r,y:i,r1:a[i][r+1],r2:a[i][r-1]}):0===a[i][r-1]&&0===a[i][r+1]&&0!==a[i-1][r]&&0!==a[i+1][r]&&(a[i-1][r]<a[i+1][r]?o.push({x:r,y:i,r1:a[i-1][r],r2:a[i+1][r]}):a[i-1][r]>a[i+1][r]&&o.push({x:r,y:i,r1:a[i+1][r],r2:a[i-1][r]})));return o}(e);i=o,i.sort((function(e,t){return e.r1<t.r1?-1:e.r1>t.r1?1:e.r2<t.r2?-1:e.r2>t.r2?1:e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}));var i;var r,h,s=n.length,l=s+1,c=o.length;for(r=0;r<c;r=h){for(h=r+1;h<c&&(o[h].r1===o[r].r1&&o[h].r2===o[r].r2);h++);if(a[o[r].r1]!==a[o[r].r2]){var m=o[Math.floor(r+(h-r)/2)],u=Math.min(a[m.r1],a[m.r2]),d=Math.max(a[m.r1],a[m.r2]);a[m.r1]=u,a[m.r2]=u;for(var f=1;f<=s;f++)a[f]===d&&(a[f]=u);t[m.y][m.x]=l}}for(var v=0;v<s;v++){var y=n[v];y.group=a[y.id]}e.connected=M(a)}(h),function(e){var t=e.data,n=e.rooms;!function(e){e.sort((function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.id<t.id?-1:e.id>t.id?1:0}))}(n);var a=function(e){var t,n,a=e.length,o=0;for(t=0;t<a;t=n){for(n=t+1;n<a&&e[n].group===e[t].group;n++);o++;for(var i=t;i<n;i++)e[i].group=o}return o}(n);if(1===a)return;var o=function(e){for(var t=e.length,n={},a=0;a<t;a++)for(var o=a+1;o<t;o++)if(e[a].group!==e[o].group){var i=z(e[a],e[o]);if(i){var r=i.alignment,h=i.distance,s=i.x,l=i.y,c=i.horizontal;if(0!==r){var m=e[a].group,u=e[o].group,d=m+"_"+u;n[d]?(n[d].distance>h||n[d].distance===h&&n[d].alignment<i)&&(n[d]={distance:h,g1:m,g2:u,room1:e[a].id,room2:e[o].id,alignment:r,x:s,y:l,horizontal:c}):n[d]={distance:h,g1:m,g2:u,room1:e[a].id,room2:e[o].id,alignment:r,x:s,y:l,horizontal:c}}}}var f=[];for(var v in n)n.hasOwnProperty(v)&&f.push(n[v]);return f}(n);i=o,i.sort((function(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:e.alignment<t.alignment?-1:e.alignment>t.alignment?1:0}));var i;for(var r=F(a),h=n.length+1,s=0;s<o.length;s++){var l=o[s];if(r[l.g1]!==r[l.g2]){var c=Math.min(r[l.g1],r[l.g2]),m=Math.max(r[l.g1],r[l.g2]);r[l.g1]=c,r[l.g2]=c;for(var u=1;u<=a;u++)r[u]===m&&(r[u]=c);var d=l.x,f=l.y,v=l.distance;if(l.horizontal)for(var y=0;y<v;y++)t[f][d+y]=h;else for(var g=0;g<v;g++)t[f+g][d]=h}}e.connected=M(r)}(h),function(e){e.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}))}(h.rooms),h}function F(e){for(var t=[],n=0;n<=e;n++)t.push(n);return t}function M(e){for(var t=1;t<e.length;t++)if(1!==e[t])return!1;return!0}function b(e,t){return Math.floor(Math.random()*(t-e+1))+e}function C(e){return e[Math.floor(Math.random()*e.length)]}function E(e,t,n,a){return!(e.x>=t.x+t.width+n||t.x>=e.x+e.width+n)&&!(e.y>=t.y+t.height+a||t.y>=e.y+e.height+a)}function z(e,t){if(e.y>t.y+t.height||t.y>e.y+e.height){if(e.x>t.x+t.width||t.x>e.x+e.width)return null;var n,a;e.y>t.y+t.height?(n=t.y+t.height,a=e.y-n):(n=e.y+e.height,a=t.y-n);var o=Math.min(e.x+e.width,t.x+t.width),i=Math.max(e.x,t.x);return{alignment:o-i,distance:a,x:Math.floor((i+o)/2),y:n,horizontal:!1}}if(e.x>t.x+t.width||t.x>e.x+e.width){var r,h;e.x>t.x+t.width?(r=t.x+t.width,h=e.x-r):(r=e.x+e.width,h=t.x-r);var s=Math.min(e.y+e.height,t.y+t.height),l=Math.max(e.y,t.y);return{alignment:s-l,distance:h,x:r,y:Math.floor((l+s)/2),horizontal:!0}}return null}function O(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}var S=function(e){function t(e){var n;Object(h.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).onResize=n.onResize.bind(Object(m.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(m.a)(n)),n.onKeyUp=n.onKeyUp.bind(Object(m.a)(n)),n.onAnimationFrame=n.onAnimationFrame.bind(Object(m.a)(n)),n.onClickPrevious=n.onClickPrevious.bind(Object(m.a)(n)),n.onClickNext=n.onClickNext.bind(Object(m.a)(n)),n.onChange=n.onChange.bind(Object(m.a)(n)),n.updateMap=n.updateMap.bind(Object(m.a)(n)),n.keys={};var a={width:112,height:63,goal:.25,zones:20,minSize:4,maxSize:10,maxRooms:0,bossRoom:!1};return n.state={showControls:!1,mode:0,modes:["Map Mode","Explore Mode"],mapOptions:a,options:[[{name:"Update Map",type:"function",function:n.updateMap},{name:"Map Width",type:"int",id:"width",min:10,max:200,value:a.width},{name:"Map Height",type:"int",id:"height",min:10,max:100,value:a.height},{name:"Room Fraction",type:"float",id:"goal",min:0,max:1,value:a.goal},{name:"Min Room Size",type:"int",id:"minSize",min:2,max:8,value:a.minSize},{name:"Max Room Size",type:"int",id:"maxSize",min:8,max:14,value:a.maxSize},{name:"Max Rooms",type:"int",id:"maxRooms",min:0,max:100,value:a.maxRooms},{name:"Zones",type:"int",id:"zones",min:0,max:20,value:a.zones},{name:"Boss Room",type:"bool",id:"bossRoom",value:a.bossRoom}],[]]},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){O(this.canvas),this.updateMap(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){O(this.canvas)}},{key:"onKeyDown",value:function(e){e.preventDefault(),this.keys[e.key]||(this.onKeyPress(e.key),this.keys[e.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(e){e.preventDefault(),this.keys[e.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(e){var t=this.state,n=t.map,a=t.player;"Escape"===e&&this.setState({showControls:!this.state.showControls});var o=0,i=0;"ArrowUp"===e?i=-1:"ArrowDown"===e?i=1:"ArrowLeft"===e?o=-1:"ArrowRight"===e&&(o=1),0===o&&0===i||0!==n.data[a.y+i][a.x+o]&&this.setState({player:{x:a.x+o,y:a.y+i}})}},{key:"onCloseMenu",value:function(){this.setState({showControls:!1})}},{key:"onAnimationFrame",value:function(){this.state&&this.state.map&&function(e,t,n){var a=t.width,o=t.height,i=t.data,r=t.rooms,h=e.getContext("2d");h.fillStyle="#000000",h.fillRect(0,0,e.width,e.height);for(var s=Math.floor(e.width/a),l=Math.floor(e.height/o),c=Math.floor((e.width-a*s)/2),m=Math.floor((e.height-o*l)/2),u=["#7F0000","#007F00","#00007F","#7F7F00","#7F007F","#007F7F","#7F3F3F","#3F7F3F","#3F3F7F","#7F7F3F","#7F3F7F","#3F7F7F"],d=0;d<o;d++)for(var f=0;f<a;f++)if(0!==i[d][f]){if(i[d][f]<=r.length){var v=r[i[d][f]-1];v.group?h.fillStyle=u[(v.group-1)%u.length]:h.fillStyle="#3F3F3F"}else h.fillStyle="#3F3F3F";h.fillRect(c+f*s+1,m+d*l+1,s-2,l-2),h.fillStyle="#FFFFFF",h.font="8px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText(i[d][f].toString(),c+f*s+s/2,m+d*l+l/2)}var y=Math.floor(r[0].x+r[0].width/2),g=Math.floor(r[0].y+r[0].height/2);h.fillStyle="#FFFFFF",h.font="50px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText("O",c+y*s+s/2,m+g*l+l/2),h.fillStyle="#FFFFFF",h.font="50px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText("X",c+n.x*s+s/2,m+n.y*l+l/2)}(this.canvas,this.state.map,this.state.player),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClickNext",value:function(){this.setState({mode:(this.state.mode+1)%this.state.modes.length})}},{key:"onClickPrevious",value:function(){this.setState({mode:(this.state.mode+this.state.modes.length-1)%this.state.modes.length})}},{key:"onChange",value:function(e,t){t!==e.value&&this.setOption(e,t)}},{key:"setOption",value:function(e,t){if(e.value=t,e.id){var n=Object.assign({},this.state.mapOptions);n[e.id]=t,this.setState({mapOptions:n})}}},{key:"updateMap",value:function(){var e=k(this.state.mapOptions),t=function(e){for(var t=e.width,n=e.height,a=e.data,o=[],i=0;i<n;i++)o.push(new Array(t).fill(0));if(0===e.rooms.length)return{x:1,y:1};var r=e.rooms[0],h=Math.floor(r.x+r.width/2),s=Math.floor(r.y+r.height/2),l=1,c=[];for(c.push({x:h,y:s});c.length>0;)for(var m=c.length,u=0;u<m;u++){var d=c.shift();l=a[d.y][d.x];for(var f=0;f<4;f++){var v=w[f];d.x+v.x<0||d.x+v.x>t-1||d.y+v.y<0||d.y+v.y>n-1||0!==a[d.y+v.y][d.x+v.x]&&0===o[d.y+v.y][d.x+v.x]&&(o[d.y+v.y][d.x+v.x]=1,c.push({x:d.x+v.x,y:d.y+v.y}))}}var y=e.rooms[l-1];return{x:h=Math.floor(y.x+y.width/2),y:s=Math.floor(y.y+y.height/2)}}(e);this.setState({map:e,player:t})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"screen"},o.a.createElement("canvas",{id:"canvas",ref:function(t){return e.canvas=t},onClick:this.onClick}),o.a.createElement(x,{show:this.state.showControls,title:this.state.modes[this.state.mode],options:this.state.options[this.state.mode],onClickPrevious:this.onClickPrevious,onClickNext:this.onClickNext,onChange:this.onChange}))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.11452aa1.chunk.js.map