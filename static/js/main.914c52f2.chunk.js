(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(t,e,n){},15:function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),a=n(3),o=n.n(a),h=(n(14),n(4)),s=n(5),l=n(7),f=n(6),c=n(0),u=n(8);function d(t,e){t=w(t),e=w(e);for(var n=[],r=0;r<e;r++)n.push(new Array(t).fill(0));for(var i=[],a=0,o=w(Math.max(Math.floor(Math.min(t/4,e/4)),3));o>=3;o-=2)for(var h=Math.pow(2,a++),s=0;s<h;s++)i.push(o);for(var l=[],f=t*e/2,c=0;c<f;){var u=m(i),d={width:u,height:u};Math.random()>.3&&(Math.random()<.5?d.width+=2:d.height+=2),l.push(d),c+=d.width*d.height}!function(t){t.sort((function(t,e){var n=t.width*t.height,r=e.width*e.height;return n<r?1:n>r?-1:0}))}(l);for(var y=l.length,x=0;x<y;x++){for(var F=l[x],k=!1,M=0;M<1e3;M++){F.x=w(v(1,t-F.width-1)),F.y=w(v(1,e-F.height-1));for(var b=!1,z=0;z<x;z++)if(g(F,l[z],F.width>=7?3:1,F.height>=7?3:1)){b=!0;break}if(!b){k=!0;break}}k||(delete F.x,delete F.y)}y=(l=l.filter((function(t){return t.x||t.y}))).length;for(var A=0;A<y;A++)for(var K=l[A],j=0;j<K.height;j++)for(var E=0;E<K.width;E++)n[K.y+j][K.x+E]=A+1;for(var O=[],S=0;S<=y;S++)O.push(S);for(var D=[],R=1;R<e-1;R++)for(var C=1;C<t-1;C++)0===n[R][C]&&(0===n[R-1][C]&&0===n[R+1][C]&&0!==n[R][C-1]&&0!==n[R][C+1]?n[R][C-1]<n[R][C+1]?D.push({x:C,y:R,r1:n[R][C-1],r2:n[R][C+1]}):n[R][C-1]>n[R][C+1]&&D.push({x:C,y:R,r1:n[R][C+1],r2:n[R][C-1]}):0===n[R][C-1]&&0===n[R][C+1]&&0!==n[R-1][C]&&0!==n[R+1][C]&&(n[R-1][C]<n[R+1][C]?D.push({x:C,y:R,r1:n[R-1][C],r2:n[R+1][C]}):n[R-1][C]>n[R+1][C]&&D.push({x:C,y:R,r1:n[R+1][C],r2:n[R-1][C]})));!function(t){t.sort((function(t,e){return t.r1<e.r1?-1:t.r1>e.r1?1:t.r2<e.r2?-1:t.r2>e.r2?1:t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}))}(D);var L,U,_=D.length;for(L=0;L<_;L=U){for(U=L+1;U<_&&(D[U].r1===D[L].r1&&D[U].r2===D[L].r2);U++);if(O[D[L].r1]!==O[D[L].r2]){var B=D[Math.floor(L+(U-L)/2)],P=Math.min(O[B.r1],O[B.r2]),V=Math.max(O[B.r1],O[B.r2]);O[B.r1]=P,O[B.r2]=P;for(var W=1;W<=y;W++)O[W]===V&&(O[W]=P);n[B.y][B.x]=y+1}}for(var q=0;q<y;q++){var I=l[q];I.id=q+1,I.group=O[I.id]}!function(t){t.sort((function(t,e){return t.group<e.group?-1:t.group>e.group?1:t.id<e.id?-1:t.id>e.id?1:0}))}(l);var J=0;for(L=0;L<y;L=U){for(U=L+1;U<y&&l[U].group===l[L].group;U++);J++;for(var T=L;T<U;T++)l[T].group=J}for(var $=[],G=0;G<J;G++)$.push(new Array(J).fill(null));for(var H=0;H<y;H++)for(var N=H+1;N<y;N++)if(l[H].group!==l[N].group){var Q=p(l[H],l[N]);if(Q){var X=Q.alignment,Y=Q.distance,Z=Q.x,tt=Q.y,et=Q.horizontal;if(0!==X){var nt=l[H].group-1,rt=l[N].group-1;(!$[nt][rt]||$[nt][rt].distance>Y||$[nt][rt].distance===Y&&$[nt][rt].alignment<X)&&($[nt][rt]={distance:Y,room1:l[H].id,room2:l[N].id,alignment:X,x:Z,y:tt,horizontal:et}),(!$[rt][nt]||$[rt][nt].distance>Y||$[rt][nt].distance===Y&&$[rt][nt].alignment<X)&&($[rt][nt]={distance:Y,room1:l[H].id,room2:l[N].id,alignment:X,x:Z,y:tt,horizontal:et})}}}for(var it=0;it<J;it++){for(var at=-1,ot=0;ot<J;ot++)$[it][ot]&&(-1===at||$[it][ot].distance<$[it][at].distance)&&(at=ot);if(-1!==at){var ht=$[it][at],st=ht.x,lt=ht.y,ft=ht.distance;if(ht.horizontal)for(var ct=0;ct<ft;ct++)n[lt][st+ct]=y+1;else for(var ut=0;ut<ft;ut++)n[lt+ut][st]=y+1}}return function(t){t.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:0}))}(l),{width:t,height:e,data:n,rooms:l}}function y(t){for(var e=0;e<t.height;e++)for(var n=0;n<t.width;n++)if(0!==t.data[e][n])return{x:n,y:e}}function v(t,e){return Math.floor(Math.random()*(e-t+1))+t}function w(t){return 2*Math.floor(t/2)+1}function m(t){return t[Math.floor(Math.random()*t.length)]}function g(t,e,n,r){return!(t.x>=e.x+e.width+n||e.x>=t.x+t.width+n)&&!(t.y>=e.y+e.height+r||e.y>=t.y+t.height+r)}function p(t,e){if(t.y>e.y+e.height||e.y>t.y+t.height){if(t.x>e.x+e.width||e.x>t.x+t.width)return null;var n,r;t.y>e.y+e.height?(n=e.y+e.height,r=t.y-n):(n=t.y+t.height,r=e.y-n);var i=Math.min(t.x+t.width,e.x+e.width),a=Math.max(t.x,e.x);return{alignment:i-a,distance:r,x:Math.floor((a+i)/2),y:n,horizontal:!1}}if(t.x>e.x+e.width||e.x>t.x+t.width){var o,h;t.x>e.x+e.width?(o=e.x+e.width,h=t.x-o):(o=t.x+t.width,h=e.x-o);var s=Math.min(t.y+t.height,e.y+e.height),l=Math.max(t.y,e.y);return{alignment:s-l,distance:h,x:o,y:Math.floor((l+s)/2),horizontal:!0}}return null}var x=function(t){function e(t){var n;Object(h.a)(this,e),(n=Object(l.a)(this,Object(f.a)(e).call(this,t))).onResize=n.onResize.bind(Object(c.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(c.a)(n)),n.onKeyUp=n.onKeyUp.bind(Object(c.a)(n)),n.onAnimationFrame=n.onAnimationFrame.bind(Object(c.a)(n)),n.onClick=n.onClick.bind(Object(c.a)(n));var r=d(101,53),i=y(r);return n.state={map:r,player:i},n.keys={},n}return Object(u.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this._resizeViewport(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){this._resizeViewport()}},{key:"onKeyDown",value:function(t){t.preventDefault(),this.keys[t.key]||(this.onKeyPress(t.key),this.keys[t.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(t){t.preventDefault(),this.keys[t.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(t){var e=this.state,n=e.map,r=e.player,i=0,a=0;"ArrowUp"===t?a=-1:"ArrowDown"===t?a=1:"ArrowLeft"===t?i=-1:"ArrowRight"===t&&(i=1),0===i&&0===a||0!==n.data[r.y+a][r.x+i]&&this.setState({player:{x:r.x+i,y:r.y+a}})}},{key:"onAnimationFrame",value:function(){this._drawMap(),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClick",value:function(){this._updateMap()}},{key:"_resizeViewport",value:function(){var t=this.canvas,e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}},{key:"_updateMap",value:function(){var t=d(101,53),e=y(t);this.setState({map:t,player:e})}},{key:"_drawMap",value:function(){var t=this.state.map,e=t.width,n=t.height,r=t.data,i=t.rooms,a=this.state.player,o=this.canvas.getContext("2d");o.fillStyle="#FFFFFF",o.fillRect(0,0,this.canvas.width,this.canvas.height);for(var h=Math.floor(this.canvas.width/e),s=Math.floor(this.canvas.height/n),l=Math.floor((this.canvas.width-e*h)/2),f=Math.floor((this.canvas.height-n*s)/2),c=["#7F0000","#007F00","#00007F","#7F7F00","#7F007F","#007F7F","#7F3F3F","#3F7F3F","#3F3F7F","#7F7F3F","#7F3F7F","#3F7F7F"],u=0;u<n;u++)for(var d=0;d<e;d++)if(0!==r[u][d]){if(r[u][d]<=i.length){var y=i[r[u][d]-1];o.fillStyle=c[(y.group-1)%c.length]}else o.fillStyle="#000000";o.fillRect(l+d*h+1,f+u*s+1,h-2,s-2),o.fillStyle="#FFFFFF",o.font="8px monospace",o.textAlign="center",o.textBaseline="middle",o.fillText(r[u][d].toString(),l+d*h+h/2,f+u*s+s/2)}o.fillStyle="#7F7FFF",o.beginPath(),o.arc(l+a.x*h+h/2,f+a.y*s+s/2,Math.min(h/4,s/4)-1,0,2*Math.PI),o.fill()}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{id:"screen"},i.a.createElement("canvas",{id:"canvas",ref:function(e){return t.canvas=e},onClick:this.onClick}))}}]),e}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},9:function(t,e,n){t.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.914c52f2.chunk.js.map