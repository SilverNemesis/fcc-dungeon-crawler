(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(t,e,r){},15:function(t,e,r){"use strict";r.r(e);var n=r(1),i=r.n(n),a=r(3),o=r.n(a),h=(r(14),r(4)),s=r(5),f=r(7),l=r(6),y=r(0),u=r(8),c=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];function d(t,e){t=g(t),e=g(e);for(var r=[],n=0;n<e;n++)r.push(new Array(t).fill(0));for(var i=[],a=0,o=g(Math.max(Math.floor(Math.min(t/4,e/4)),3));o>=3;o-=2)for(var h=Math.pow(2,a++),s=0;s<h;s++)i.push(o);for(var f=[],l=t*e/2,y=0;y<l;){var u=w(i),c={width:u,height:u};Math.random()>.3&&(Math.random()<.5?c.width+=2:c.height+=2),f.push(c),y+=c.width*c.height}!function(t){t.sort((function(t,e){var r=t.width*t.height,n=e.width*e.height;return r<n?1:r>n?-1:0}))}(f);for(var d=f.length,p=0;p<d;p++){for(var F=f[p],k=!1,M=0;M<1e3;M++){F.x=g(v(1,t-F.width-1)),F.y=g(v(1,e-F.height-1));for(var b=!1,z=0;z<p;z++)if(x(F,f[z],F.width>=7?3:1,F.height>=7?3:1)){b=!0;break}if(!b){k=!0;break}}k||(delete F.x,delete F.y)}d=(f=f.filter((function(t){return t.x||t.y}))).length;for(var A=0;A<d;A++)for(var K=f[A],O=0;O<K.height;O++)for(var j=0;j<K.width;j++)r[K.y+O][K.x+j]=A+1;for(var E=[],S=0;S<=d;S++)E.push(S);for(var D=[],R=1;R<e-1;R++)for(var _=1;_<t-1;_++)0===r[R][_]&&(0===r[R-1][_]&&0===r[R+1][_]&&0!==r[R][_-1]&&0!==r[R][_+1]?r[R][_-1]<r[R][_+1]?D.push({x:_,y:R,r1:r[R][_-1],r2:r[R][_+1]}):r[R][_-1]>r[R][_+1]&&D.push({x:_,y:R,r1:r[R][_+1],r2:r[R][_-1]}):0===r[R][_-1]&&0===r[R][_+1]&&0!==r[R-1][_]&&0!==r[R+1][_]&&(r[R-1][_]<r[R+1][_]?D.push({x:_,y:R,r1:r[R-1][_],r2:r[R+1][_]}):r[R-1][_]>r[R+1][_]&&D.push({x:_,y:R,r1:r[R+1][_],r2:r[R-1][_]})));D.sort((function(t,e){return t.r1<e.r1?-1:t.r1>e.r1?1:t.r2<e.r2?-1:t.r2>e.r2?1:t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}));var C,L,U=D.length;for(C=0;C<U;C=L){for(L=C+1;L<U&&(D[L].r1===D[C].r1&&D[L].r2===D[C].r2);L++);if(E[D[C].r1]!==E[D[C].r2]){var P=D[Math.floor(C+(L-C)/2)],B=Math.min(E[P.r1],E[P.r2]),V=Math.max(E[P.r1],E[P.r2]);E[P.r1]=B,E[P.r2]=B;for(var W=1;W<=d;W++)E[W]===V&&(E[W]=B);r[P.y][P.x]=d+1}}for(var q=0;q<d;q++){var I=f[q];I.id=q+1,I.group=E[I.id]}!function(t){t.sort((function(t,e){return t.group<e.group?-1:t.group>e.group?1:t.id<e.id?-1:t.id>e.id?1:0}))}(f);var J=0;for(C=0;C<d;C=L){for(L=C+1;L<d&&f[L].group===f[C].group;L++);J++;for(var T=C;T<L;T++)f[T].group=J}for(var $={},G=0;G<d;G++)for(var H=G+1;H<d;H++)if(f[G].group!==f[H].group){var N=m(f[G],f[H]);if(N){var Q=N.alignment,X=N.distance,Y=N.x,Z=N.y,tt=N.horizontal;if(0!==Q){var et=f[G].group,rt=f[H].group,nt=et+"_"+rt;$[nt]?($[nt].distance>X||$[nt].distance===X&&$[nt].alignment<N)&&($[nt]={distance:X,g1:et,g2:rt,room1:f[G].id,room2:f[H].id,alignment:Q,x:Y,y:Z,horizontal:tt}):$[nt]={distance:X,g1:et,g2:rt,room1:f[G].id,room2:f[H].id,alignment:Q,x:Y,y:Z,horizontal:tt}}}}var it=[];for(var at in $)$.hasOwnProperty(at)&&it.push($[at]);!function(t){t.sort((function(t,e){return t.distance<e.distance?-1:t.distance>e.distance?1:t.alignment<e.alignment?-1:t.alignment>e.alignment?1:0}))}(it);for(var ot=[],ht=0;ht<=J;ht++)ot.push(ht);for(var st=0;st<it.length;st++){var ft=it[st];if(ot[ft.g1]!==ot[ft.g2]){var lt=Math.min(ot[ft.g1],ot[ft.g2]),yt=Math.max(ot[ft.g1],ot[ft.g2]);ot[ft.g1]=lt,ot[ft.g2]=lt;for(var ut=1;ut<=J;ut++)ot[ut]===yt&&(ot[ut]=lt);var ct=ft.x,dt=ft.y,vt=ft.distance;if(ft.horizontal)for(var gt=0;gt<vt;gt++)r[dt][ct+gt]=d+1;else for(var wt=0;wt<vt;wt++)r[dt+wt][ct]=d+1}}for(var xt=!0,mt=1;mt<=J;mt++)1!==ot[mt]&&(xt=!1);return function(t){t.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:0}))}(f),{width:t,height:e,data:r,rooms:f,connected:xt}}function v(t,e){return Math.floor(Math.random()*(e-t+1))+t}function g(t){return 2*Math.floor(t/2)+1}function w(t){return t[Math.floor(Math.random()*t.length)]}function x(t,e,r,n){return!(t.x>=e.x+e.width+r||e.x>=t.x+t.width+r)&&!(t.y>=e.y+e.height+n||e.y>=t.y+t.height+n)}function m(t,e){if(t.y>e.y+e.height||e.y>t.y+t.height){if(t.x>e.x+e.width||e.x>t.x+t.width)return null;var r,n;t.y>e.y+e.height?(r=e.y+e.height,n=t.y-r):(r=t.y+t.height,n=e.y-r);var i=Math.min(t.x+t.width,e.x+e.width),a=Math.max(t.x,e.x);return{alignment:i-a,distance:n,x:Math.floor((a+i)/2),y:r,horizontal:!1}}if(t.x>e.x+e.width||e.x>t.x+t.width){var o,h;t.x>e.x+e.width?(o=e.x+e.width,h=t.x-o):(o=t.x+t.width,h=e.x-o);var s=Math.min(t.y+t.height,e.y+e.height),f=Math.max(t.y,e.y);return{alignment:s-f,distance:h,x:o,y:Math.floor((f+s)/2),horizontal:!0}}return null}var p=function(t){function e(t){var r;return Object(h.a)(this,e),(r=Object(f.a)(this,Object(l.a)(e).call(this,t))).onResize=r.onResize.bind(Object(y.a)(r)),r.onKeyDown=r.onKeyDown.bind(Object(y.a)(r)),r.onKeyUp=r.onKeyUp.bind(Object(y.a)(r)),r.onAnimationFrame=r.onAnimationFrame.bind(Object(y.a)(r)),r.onClick=r.onClick.bind(Object(y.a)(r)),r.keys={},r}return Object(u.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this._resizeViewport(),this._updateMap(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){this._resizeViewport()}},{key:"onKeyDown",value:function(t){t.preventDefault(),this.keys[t.key]||(this.onKeyPress(t.key),this.keys[t.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(t){t.preventDefault(),this.keys[t.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(t){var e=this.state,r=e.map,n=e.player,i=0,a=0;"ArrowUp"===t?a=-1:"ArrowDown"===t?a=1:"ArrowLeft"===t?i=-1:"ArrowRight"===t&&(i=1),0===i&&0===a||0!==r.data[n.y+a][n.x+i]&&this.setState({player:{x:n.x+i,y:n.y+a}})}},{key:"onAnimationFrame",value:function(){this._drawMap(),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClick",value:function(){this._updateMap()}},{key:"_resizeViewport",value:function(){var t=this.canvas,e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}},{key:"_updateMap",value:function(){for(var t=d(53,27);t.rooms.length<25;)t=d(53,27);var e=function(t){for(var e=t.width,r=t.height,n=t.data,i=[],a=0;a<r;a++)i.push(new Array(e).fill(0));var o=t.rooms[0],h=Math.floor(o.x+o.width/2),s=Math.floor(o.y+o.height/2),f=1,l=[];for(l.push({x:h,y:s});l.length>0;)for(var y=l.length,u=0;u<y;u++){var d=l.shift();f=n[d.y][d.x];for(var v=0;v<4;v++){var g=c[v];d.x+g.x<0||d.x+g.x>e-1||d.y+g.y<0||d.y+g.y>r-1||0!==n[d.y+g.y][d.x+g.x]&&0===i[d.y+g.y][d.x+g.x]&&(i[d.y+g.y][d.x+g.x]=1,l.push({x:d.x+g.x,y:d.y+g.y}))}}var w=t.rooms[f-1];return{x:h=Math.floor(w.x+w.width/2),y:s=Math.floor(w.y+w.height/2)}}(t);this.setState({map:t,player:e})}},{key:"_drawMap",value:function(){if(this.state&&this.state.map){var t=this.state.map,e=t.width,r=t.height,n=t.data,i=t.rooms,a=this.state.player,o=this.canvas.getContext("2d");o.fillStyle="#FFFFFF",o.fillRect(0,0,this.canvas.width,this.canvas.height);for(var h=Math.floor(this.canvas.width/e),s=Math.floor(this.canvas.height/r),f=Math.floor((this.canvas.width-e*h)/2),l=Math.floor((this.canvas.height-r*s)/2),y=["#7F0000","#007F00","#00007F","#7F7F00","#7F007F","#007F7F","#7F3F3F","#3F7F3F","#3F3F7F","#7F7F3F","#7F3F7F","#3F7F7F"],u=0;u<r;u++)for(var c=0;c<e;c++)if(0!==n[u][c]){if(n[u][c]<=i.length){var d=i[n[u][c]-1];o.fillStyle=y[(d.group-1)%y.length]}else o.fillStyle="#000000";o.fillRect(f+c*h+1,l+u*s+1,h-2,s-2),o.fillStyle="#FFFFFF",o.font="8px monospace",o.textAlign="center",o.textBaseline="middle",o.fillText(n[u][c].toString(),f+c*h+h/2,l+u*s+s/2)}o.fillStyle="#7F7FFF",o.beginPath(),o.arc(f+a.x*h+h/2,l+a.y*s+s/2,Math.min(h/4,s/4)-1,0,2*Math.PI),o.fill()}}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{id:"screen"},i.a.createElement("canvas",{id:"canvas",ref:function(e){return t.canvas=e},onClick:this.onClick}))}}]),e}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},9:function(t,e,r){t.exports=r(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.cf832606.chunk.js.map