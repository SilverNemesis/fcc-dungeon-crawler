(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(3),i=n.n(r),h=(n(14),n(4)),s=n(5),l=n(7),c=n(6),u=n(1),d=n(8),f=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},t.description)},m=function(e){for(var t=e.control,n=[],a=0;a<t.options.length;a++)n.push(o.a.createElement("option",{key:a,value:a},t.options[a]));return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name),o.a.createElement("select",{id:t.name,className:"select-css",value:t.value,onChange:function(n){e.onChange(t,n.target.value)}},n))},v=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{className:"clickable",htmlFor:t.name},o.a.createElement("input",{className:"clickable",id:t.name,type:"checkbox",checked:t.value,onChange:function(n){e.onChange(t,n.target.checked)}}),t.name))},y=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name," ",t.value),o.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:t.min,max:t.max,value:t.value,onChange:function(n){e.onChange(t,n.target.value)}}))},g=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name," ",t.value.toFixed(3)),o.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:Math.floor(1e3*t.min),max:Math.floor(1e3*t.max),value:Math.floor(1e3*t.value),onChange:function(n){e.onChange(t,n.target.value/1e3)}}))},p=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("button",{onClick:function(e){t.function()}},t.name))},x=function(e){var t,n=e.show,a=e.title,r=e.onClickPrevious,i=e.onClickNext,h=e.onChange,s=e.options;return n?(s&&(t=s.map((function(e,t){switch(e.type){case"description":return o.a.createElement(f,{key:t,control:e});case"select":return o.a.createElement(m,{key:t,control:e,onChange:h});case"bool":return o.a.createElement(v,{key:t,control:e,onChange:h});case"int":return o.a.createElement(y,{key:t,control:e,onChange:h});case"float":return o.a.createElement(g,{key:t,control:e,onChange:h});case"function":return o.a.createElement(p,{key:t,control:e});default:return o.a.createElement("div",{key:t,className:"control"},e.type," is not supported")}}))),o.a.createElement("div",{id:"controls"},o.a.createElement("div",{className:"none"},o.a.createElement("span",{className:"left",onClick:r},"\u276e PREV"),o.a.createElement("span",{className:"right",onClick:i},"NEXT \u276f"),o.a.createElement("div",{className:"center title"},a)),o.a.createElement("div",null,t))):null},w=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];function k(e){for(var t=e.width,n=e.height,a=e.zones,o=e.bossRoom,r=[],i=0;i<n;i++)r.push(new Array(t).fill(0));var h={width:t,height:n,data:r};!function(e,t){var n=e.width,a=e.height,o=t.goal,r=t.minSize,i=t.maxSize;o||(o=.5);r||(r=3);i||(i=Math.max(Math.floor(Math.min(n/4,a/4)),r));for(var h=[],s=0,l=i;l>=r;l--)for(var c=Math.pow(2,s++),u=0;u<c;u++)h.push(l);var d=[],f=n*a*o,m=0;for(;m<f;){var v=M(h),y={width:v,height:v};Math.random()>.3&&(Math.random()<.5?y.width+=2:y.height+=2),d.push(y),m+=y.width*y.height}e.rooms=d}(h,e),h.rooms.sort((function(e,t){var n=e.width*e.height,a=t.width*t.height;return n<a?1:n>a?-1:0}));var s=e.maxRooms;if(a&&a>1){if(function(e,t){for(var n=e.width,a=e.height,o=[],r=0;r<t;r++)o[r]=r;!function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}}(o);for(var i=Math.floor((n-2)/t),h=Math.floor((a-2)/t),s=[],l=0;l<t;l++){var c={x:l*i+1,y:o[l]*h+1,width:i,height:h};s.push(c)}e.zones=s}(h,a),o){var l=h.rooms[0],c=h.zones[0];l.width<=c.width&&l.height<=c.height&&(l.x=Math.floor(c.x),l.y=Math.floor(c.y+(c.height-l.height)/2))}var u=function(e,t){for(var n=e.width,a=e.height,o=e.rooms,r=e.zones,i=0,h=0,s=o.length,l=0;l<s&&(!t||i!==t);l++){var c=o[l];if(!c.hasOwnProperty("x")||!c.hasOwnProperty("y")){var u=r[h].x,d=Math.min(r[h].x+r[h].width,n-c.width-1),f=r[h].y,m=Math.min(r[h].y+r[h].height,a-c.height-1);if(!(u+c.width>n-1||f+c.height>a-1)){for(var v=!1,y=0;y<100;y++){c.x=F(u,d),c.y=F(f,m);for(var g=!1,p=0;p<s;p++)if(p!==l&&o[p].hasOwnProperty("x")&&o[p].hasOwnProperty("y")&&C(c,o[p],1,1)){g=!0;break}if(!g){v=!0;break}}v?(i++,h=(h+1)%r.length):(delete c.x,delete c.y)}}}return i}(h,s);void 0!==s&&(s-=u)}else if(o){var d=h.rooms[0];d.width<=t-2&&d.height<=n-2&&(d.x=Math.floor((t-d.width)/2),d.y=Math.floor((n-d.height)/2))}return function(e,t){for(var n=e.width,a=e.height,o=e.rooms,r=0,i=o.length,h=0;h<i&&(void 0===t||r!==t);h++){var s=o[h];if(!s.hasOwnProperty("x")||!s.hasOwnProperty("y")){for(var l=!1,c=0;c<1e3;c++){s.x=F(1,n-s.width-1),s.y=F(1,a-s.height-1);for(var u=!1,d=0;d<i;d++)if(d!==h&&o[d].hasOwnProperty("x")&&o[d].hasOwnProperty("y")&&C(s,o[d],s.width>=7?3:1,s.height>=7?3:1)){u=!0;break}if(!u){l=!0;break}}l?r++:(delete s.x,delete s.y)}}e.rooms=e.rooms.filter((function(e){return e.x||e.y})),e.rooms.length}(h,s),function(e){for(var t=e.width,n=e.height,a=e.data,o=e.rooms,r=o.length,i=0;i<r;i++){var h=o[i];h.id=i+1;for(var s=0;s<h.height;s++)for(var l=0;l<h.width;l++)a[h.y+s][h.x+l]=h.id}for(var c=[],u=0;u<=r;u++)c.push(u);for(var d=[],f=1;f<n-1;f++)for(var m=1;m<t-1;m++)0===a[f][m]&&(0===a[f-1][m]&&0===a[f+1][m]&&0!==a[f][m-1]&&0!==a[f][m+1]?a[f][m-1]<a[f][m+1]?d.push({x:m,y:f,r1:a[f][m-1],r2:a[f][m+1]}):a[f][m-1]>a[f][m+1]&&d.push({x:m,y:f,r1:a[f][m+1],r2:a[f][m-1]}):0===a[f][m-1]&&0===a[f][m+1]&&0!==a[f-1][m]&&0!==a[f+1][m]&&(a[f-1][m]<a[f+1][m]?d.push({x:m,y:f,r1:a[f-1][m],r2:a[f+1][m]}):a[f-1][m]>a[f+1][m]&&d.push({x:m,y:f,r1:a[f+1][m],r2:a[f-1][m]})));v=d,v.sort((function(e,t){return e.r1<t.r1?-1:e.r1>t.r1?1:e.r2<t.r2?-1:e.r2>t.r2?1:e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}));var v;var y,g,p=d.length;for(y=0;y<p;y=g){for(g=y+1;g<p&&(d[g].r1===d[y].r1&&d[g].r2===d[y].r2);g++);if(c[d[y].r1]!==c[d[y].r2]){var x=d[Math.floor(y+(g-y)/2)],w=Math.min(c[x.r1],c[x.r2]),k=Math.max(c[x.r1],c[x.r2]);c[x.r1]=w,c[x.r2]=w;for(var F=1;F<=r;F++)c[F]===k&&(c[F]=w);a[x.y][x.x]=r+1}}for(var M=0;M<r;M++){var C=o[M];C.group=c[C.id]}}(h),function(e){var t=e.data,n=e.rooms,a=n.length;!function(e){e.sort((function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.id<t.id?-1:e.id>t.id?1:0}))}(n);var o,r,i=0;for(o=0;o<a;o=r){for(r=o+1;r<a&&n[r].group===n[o].group;r++);i++;for(var h=o;h<r;h++)n[h].group=i}for(var s={},l=0;l<a;l++)for(var c=l+1;c<a;c++)if(n[l].group!==n[c].group){var u=E(n[l],n[c]);if(u){var d=u.alignment,f=u.distance,m=u.x,v=u.y,y=u.horizontal;if(0!==d){var g=n[l].group,p=n[c].group,x=g+"_"+p;s[x]?(s[x].distance>f||s[x].distance===f&&s[x].alignment<u)&&(s[x]={distance:f,g1:g,g2:p,room1:n[l].id,room2:n[c].id,alignment:d,x:m,y:v,horizontal:y}):s[x]={distance:f,g1:g,g2:p,room1:n[l].id,room2:n[c].id,alignment:d,x:m,y:v,horizontal:y}}}}var w=[];for(var k in s)s.hasOwnProperty(k)&&w.push(s[k]);F=w,F.sort((function(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:e.alignment<t.alignment?-1:e.alignment>t.alignment?1:0}));var F;for(var M=[],C=0;C<=i;C++)M.push(C);for(var b=0;b<w.length;b++){var z=w[b];if(M[z.g1]!==M[z.g2]){var O=Math.min(M[z.g1],M[z.g2]),N=Math.max(M[z.g1],M[z.g2]);M[z.g1]=O,M[z.g2]=O;for(var S=1;S<=i;S++)M[S]===N&&(M[S]=O);var P=z.x,A=z.y,K=z.distance;if(z.horizontal)for(var j=0;j<K;j++)t[A][P+j]=a+1;else for(var R=0;R<K;R++)t[A+R][P]=a+1}}e.connected=!0;for(var D=1;D<=i;D++)if(1!==M[D]){e.connected=!1;break}}(h),function(e){e.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}))}(h.rooms),h}function F(e,t){return Math.floor(Math.random()*(t-e+1))+e}function M(e){return e[Math.floor(Math.random()*e.length)]}function C(e,t,n,a){return!(e.x>=t.x+t.width+n||t.x>=e.x+e.width+n)&&!(e.y>=t.y+t.height+a||t.y>=e.y+e.height+a)}function E(e,t){if(e.y>t.y+t.height||t.y>e.y+e.height){if(e.x>t.x+t.width||t.x>e.x+e.width)return null;var n,a;e.y>t.y+t.height?(n=t.y+t.height,a=e.y-n):(n=e.y+e.height,a=t.y-n);var o=Math.min(e.x+e.width,t.x+t.width),r=Math.max(e.x,t.x);return{alignment:o-r,distance:a,x:Math.floor((r+o)/2),y:n,horizontal:!1}}if(e.x>t.x+t.width||t.x>e.x+e.width){var i,h;e.x>t.x+t.width?(i=t.x+t.width,h=e.x-i):(i=e.x+e.width,h=t.x-i);var s=Math.min(e.y+e.height,t.y+t.height),l=Math.max(e.y,t.y);return{alignment:s-l,distance:h,x:i,y:Math.floor((l+s)/2),horizontal:!0}}return null}var b=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(l.a)(this,Object(c.a)(t).call(this,e))).onResize=n.onResize.bind(Object(u.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(u.a)(n)),n.onKeyUp=n.onKeyUp.bind(Object(u.a)(n)),n.onAnimationFrame=n.onAnimationFrame.bind(Object(u.a)(n)),n.onClickPrevious=n.onClickPrevious.bind(Object(u.a)(n)),n.onClickNext=n.onClickNext.bind(Object(u.a)(n)),n.onChange=n.onChange.bind(Object(u.a)(n)),n.updateMap=n.updateMap.bind(Object(u.a)(n)),n.keys={},n.state={showControls:!1,mode:0,modes:["Map Mode","Explore Mode"],options:[[{name:"Update Map",type:"function",function:n.updateMap}],[]]},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._resizeViewport(),this.updateMap(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){this._resizeViewport()}},{key:"onKeyDown",value:function(e){e.preventDefault(),this.keys[e.key]||(this.onKeyPress(e.key),this.keys[e.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(e){e.preventDefault(),this.keys[e.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(e){var t=this.state,n=t.map,a=t.player;"Escape"===e&&this.setState({showControls:!this.state.showControls});var o=0,r=0;"ArrowUp"===e?r=-1:"ArrowDown"===e?r=1:"ArrowLeft"===e?o=-1:"ArrowRight"===e&&(o=1),0===o&&0===r||0!==n.data[a.y+r][a.x+o]&&this.setState({player:{x:a.x+o,y:a.y+r}})}},{key:"onCloseMenu",value:function(){this.setState({showControls:!1})}},{key:"onAnimationFrame",value:function(){this._drawMap(),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClickNext",value:function(){this.setState({mode:(this.state.mode+1)%this.state.modes.length})}},{key:"onClickPrevious",value:function(){this.setState({mode:(this.state.mode+this.state.modes.length-1)%this.state.modes.length})}},{key:"onChange",value:function(e,t){t!==e.value&&(this.setOption(e,t),this.forceUpdate())}},{key:"setOption",value:function(e,t){}},{key:"_resizeViewport",value:function(){var e=this.canvas,t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}},{key:"updateMap",value:function(){var e=k({width:112,height:63,goal:.25,zones:20,minSize:4,maxSize:10}),t=function(e){for(var t=e.width,n=e.height,a=e.data,o=[],r=0;r<n;r++)o.push(new Array(t).fill(0));if(0===e.rooms.length)return{x:1,y:1};var i=e.rooms[0],h=Math.floor(i.x+i.width/2),s=Math.floor(i.y+i.height/2),l=1,c=[];for(c.push({x:h,y:s});c.length>0;)for(var u=c.length,d=0;d<u;d++){var f=c.shift();l=a[f.y][f.x];for(var m=0;m<4;m++){var v=w[m];f.x+v.x<0||f.x+v.x>t-1||f.y+v.y<0||f.y+v.y>n-1||0!==a[f.y+v.y][f.x+v.x]&&0===o[f.y+v.y][f.x+v.x]&&(o[f.y+v.y][f.x+v.x]=1,c.push({x:f.x+v.x,y:f.y+v.y}))}}var y=e.rooms[l-1];return{x:h=Math.floor(y.x+y.width/2),y:s=Math.floor(y.y+y.height/2)}}(e);this.setState({map:e,player:t})}},{key:"_drawMap",value:function(){if(this.state&&this.state.map){var e=this.state.map,t=e.width,n=e.height,a=e.data,o=e.rooms,r=this.state.player,i=this.canvas.getContext("2d");i.fillStyle="#000000",i.fillRect(0,0,this.canvas.width,this.canvas.height);for(var h=Math.floor(this.canvas.width/t),s=Math.floor(this.canvas.height/n),l=Math.floor((this.canvas.width-t*h)/2),c=Math.floor((this.canvas.height-n*s)/2),u=["#7F0000","#007F00","#00007F","#7F7F00","#7F007F","#007F7F","#7F3F3F","#3F7F3F","#3F3F7F","#7F7F3F","#7F3F7F","#3F7F7F"],d=0;d<n;d++)for(var f=0;f<t;f++)if(0!==a[d][f]){if(a[d][f]<=o.length){var m=o[a[d][f]-1];m.group?i.fillStyle=u[(m.group-1)%u.length]:i.fillStyle="#3F3F3F"}else i.fillStyle="#3F3F3F";i.fillRect(l+f*h+1,c+d*s+1,h-2,s-2),i.fillStyle="#FFFFFF",i.font="8px monospace",i.textAlign="center",i.textBaseline="middle",i.fillText(a[d][f].toString(),l+f*h+h/2,c+d*s+s/2)}var v=Math.floor(o[0].x+o[0].width/2),y=Math.floor(o[0].y+o[0].height/2);i.fillStyle="#FFFFFF",i.font="50px monospace",i.textAlign="center",i.textBaseline="middle",i.fillText("O",l+v*h+h/2,c+y*s+s/2),i.fillStyle="#FFFFFF",i.font="50px monospace",i.textAlign="center",i.textBaseline="middle",i.fillText("X",l+r.x*h+h/2,c+r.y*s+s/2)}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"screen"},o.a.createElement("canvas",{id:"canvas",ref:function(t){return e.canvas=t},onClick:this.onClick}),o.a.createElement(x,{show:this.state.showControls,title:this.state.modes[this.state.mode],options:this.state.options[this.state.mode],onClickPrevious:this.onClickPrevious,onClickNext:this.onClickNext,onChange:this.onChange}))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.2b4629ca.chunk.js.map