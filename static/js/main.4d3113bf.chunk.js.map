{"version":3,"sources":["components/Controls.js","lib/map.js","lib/draw.js","components/App.js","serviceWorker.js","index.js"],"names":["DescriptionControl","props","control","className","description","SelectControl","options","i","length","push","key","value","htmlFor","name","id","onChange","event","target","BoolControl","type","checked","IntControl","min","max","Number","FloatControl","toFixed","Math","floor","FunctionControl","onClick","function","Controls","controls","show","title","onClickPrevious","onClickNext","map","option","index","_directions","x","y","generateDungeon","width","height","zones","bossRoom","data","Array","fill","targetArea","goal","minSize","maxSize","roomSize","power","s","count","pow","c","rooms","area","size","_pickRandom","room","random","_generateRooms","sort","pri","sec","priArea","secArea","maxRooms","undefined","loc","j","t","_shuffle","xStep","yStep","zone","totalArea","growth","dirs","_canZoneGrow","_generateZones","placedRooms","zoneIndex","zonedRooms","roomCount","roomIndex","hasOwnProperty","minX","maxX","minY","maxY","isPlaced","_range","overlap","_doRoomsOverlap","_placeRoomsByZone","placed","filter","_placeRooms","h","w","_addRoomsToMap","links","_generateLinks","roomConnectors","r1","r2","_generateRoomConnectors","connectors","cur","nxt","connectorId","conCount","apl","group","connected","_isMapConnected","_connectNearbyRooms","_sortRooms_GroupAndId","groupCount","_renumberGroups","groupConnectors","roomInfoList","alignmentAndDistance","_getAlignmentAndDistance","alignment","distance","horizontal","g1","g2","room1","room2","prop","_generateGroupConnectors","groupLinks","groupConnector","o","_connectDistantRooms","_sortRooms_Id","_doZonesOverlap","borderX","borderY","resizeViewport","canvas","rect","getBoundingClientRect","App","onResize","bind","onKeyDown","onKeyUp","onAnimationFrame","updateMap","keys","mapOptions","state","showControls","mode","modes","this","window","addEventListener","frame","requestAnimationFrame","removeEventListener","cancelAnimationFrame","preventDefault","onKeyPress","captureKeys","scene","keyboardState","player","setState","dx","dy","ctx","getContext","fillStyle","fillRect","cellWidth","cellHeight","xOffset","yOffset","colors","font","textAlign","textBaseline","fillText","toString","boss","drawMap","setOption","Object","assign","visited","q","top","shift","dir","playerRoom","getPlayerStartingLocation","ref","elem","React","Component","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.4d3113bf.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nconst DescriptionControl = (props) => {\r\n  const { control } = props;\r\n  return (\r\n    <div className=\"control\">\r\n      {control.description}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst SelectControl = (props) => {\r\n  function onChange(event) {\r\n    props.onChange(control, event.target.value);\r\n  }\r\n  const { control } = props;\r\n  const options = [];\r\n  for (let i = 0; i < control.options.length; i++) {\r\n    options.push(\r\n      (<option key={i} value={i}>{control.options[i]}</option>)\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"control\">\r\n      <label htmlFor={control.name}>{control.name}</label>\r\n      <select id={control.name} className=\"select-css\" value={control.value} onChange={onChange}>\r\n        {options}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst BoolControl = (props) => {\r\n  function onChange(event) {\r\n    props.onChange(control, event.target.checked);\r\n  }\r\n  const { control } = props;\r\n  return (\r\n    <div className=\"control\">\r\n      <label className=\"clickable\" htmlFor={control.name}><input className=\"clickable\" id={control.name} type=\"checkbox\" checked={control.value} onChange={onChange} />{control.name}</label>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst IntControl = (props) => {\r\n  function onChange(event) {\r\n    props.onChange(control, Number(event.target.value));\r\n  }\r\n  const { control } = props;\r\n  return (\r\n    <div className=\"control\">\r\n      <label htmlFor={control.name}>{control.name} {control.value}</label>\r\n      <input id={control.name} className=\"clickable\" type=\"range\" min={control.min} max={control.max} value={control.value} onChange={onChange} />\r\n    </div>\r\n  );\r\n}\r\n\r\nconst FloatControl = (props) => {\r\n  const factor = 1000;\r\n  function onChange(event) {\r\n    props.onChange(control, Number(event.target.value) / factor);\r\n  }\r\n  const { control } = props;\r\n  return (\r\n    <div className=\"control\">\r\n      <label htmlFor={control.name}>{control.name} {control.value.toFixed(3)}</label>\r\n      <input id={control.name} className=\"clickable\" type=\"range\" min={Math.floor(control.min * factor)} max={Math.floor(control.max * factor)} value={Math.floor(control.value * factor)} onChange={onChange} />\r\n    </div>\r\n  );\r\n}\r\n\r\nconst FunctionControl = (props) => {\r\n  function onClick(event) {\r\n    control.function();\r\n  }\r\n  const { control } = props;\r\n  return (\r\n    <div className=\"control\">\r\n      <button onClick={onClick}>{control.name}</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst Controls = ({ show, title, onClickPrevious, onClickNext, onChange, options }) => {\r\n  if (!show) {\r\n    return null;\r\n  }\r\n  let controls\r\n  if (options) {\r\n    controls = options.map((option, index) => {\r\n      switch (option.type) {\r\n        case 'description':\r\n          return <DescriptionControl key={index} control={option} />\r\n        case 'select':\r\n          return <SelectControl key={index} control={option} onChange={onChange} />\r\n        case 'bool':\r\n          return <BoolControl key={index} control={option} onChange={onChange} />\r\n        case 'int':\r\n          return <IntControl key={index} control={option} onChange={onChange} />\r\n        case 'float':\r\n          return <FloatControl key={index} control={option} onChange={onChange} />\r\n        case 'function':\r\n          return <FunctionControl key={index} control={option} />\r\n        default:\r\n          return (\r\n            <div key={index} className=\"control\">{option.type} is not supported</div>\r\n          );\r\n      }\r\n    });\r\n  }\r\n  return (\r\n    <div id=\"controls\">\r\n      <div className=\"none\">\r\n        <span className=\"left\" onClick={onClickPrevious}>❮ PREV</span>\r\n        <span className=\"right\" onClick={onClickNext}>NEXT ❯</span>\r\n        <div className=\"center title\">{title}</div>\r\n      </div>\r\n      <div>\r\n        {controls}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Controls;\r\n","/** \r\n * @fileOverview Map creation logic\r\n */\r\n\r\n/** @constant {number} _directions - list of the cardinal directions */\r\nconst _directions = [\r\n  { x: 0, y: -1 },\r\n  { x: 1, y: 0 },\r\n  { x: 0, y: 1 },\r\n  { x: -1, y: 0 }\r\n];\r\n\r\n/**\r\n * Options type definition\r\n * @typedef {Object} Options\r\n * @property {number} width - width of the dungeon\r\n * @property {number} height - height of the dungeon\r\n * @property {number} zones - number of zones in the dungeon\r\n * @property {boolean} bossRoom - whether ot not to use \"boss room\" logic\r\n * @property {number} goal - the fraction of the map to contain rooms\r\n * @property {number} maxRooms - the maximum number of rooms in the dungeon\r\n * @property {number} minSize - minimum room width and height\r\n * @property {number} maxSize - maximum base room width and height (excluding rectangle add on)\r\n */\r\n\r\n/**\r\n * Map type definition\r\n * @typedef {Object} Map\r\n * @property {number} width - width of the dungeon\r\n * @property {number} height - height of the dungeon\r\n * @property {number[][]} data - the map of the dungeon\r\n * @property {Room[]} rooms - the rooms in the dungeon\r\n * @property {Zone[]} zones - the zones in the dungeon\r\n * @property {boolean} connected - whether or not all the rooms are connected\r\n */\r\n\r\n/**\r\n * Room type definition\r\n * @typedef {Object} Room\r\n * @property {number} width - width of the room\r\n * @property {number} height - height of the room\r\n * @property {number} x - x coordinate of upper corner of room\r\n * @property {number} y - y coordinate of upper corner of room\r\n * @property {number} id - the room id\r\n * @property {number} group - the group that contains the room\r\n */\r\n\r\n/**\r\n * Map type definition\r\n * @typedef {Object} Zone\r\n * @property {number} width - width of the zone\r\n * @property {number} height - height of the zone\r\n * @property {number} x - x coordinate of upper corner of zone\r\n * @property {number} y - y coordinate of upper corner of zone\r\n */\r\n\r\n/**\r\n * Generates a dungeon\r\n * @param {Options} options\r\n * @returns {Map}\r\n */\r\nexport function generateDungeon(options) {\r\n  const { width, height, zones, bossRoom } = options;\r\n  const data = [];\r\n  for (let y = 0; y < height; y++) {\r\n    data.push(new Array(width).fill(0));\r\n  }\r\n\r\n  const map = {\r\n    width,\r\n    height,\r\n    data\r\n  }\r\n\r\n  const targetArea = _generateRooms(map, options);\r\n\r\n  _sortRooms_LargestToSmallest(map.rooms);\r\n\r\n  let { maxRooms } = options;\r\n\r\n  if (maxRooms === 0) {\r\n    maxRooms = undefined;\r\n  }\r\n\r\n  if (zones && zones > 1) {\r\n    _generateZones(map, zones, targetArea);\r\n    if (bossRoom) {\r\n      const room = map.rooms[0];\r\n      const zone = map.zones[0];\r\n      if (room.width <= zone.width && room.height <= zone.height) {\r\n        room.x = Math.floor(zone.x);\r\n        room.y = Math.floor(zone.y + (zone.height - room.height) / 2);\r\n        room.zone = 1;\r\n        if (maxRooms !== undefined) {\r\n          maxRooms--;\r\n        }\r\n      }\r\n    }\r\n    const placedRooms = _placeRoomsByZone(map, maxRooms);\r\n    if (maxRooms !== undefined) {\r\n      maxRooms -= placedRooms;\r\n    }\r\n  } else {\r\n    if (bossRoom) {\r\n      const room = map.rooms[0];\r\n      if (room.width <= width - 2 && room.height <= height - 2) {\r\n        room.x = Math.floor((width - room.width) / 2);\r\n        room.y = Math.floor((height - room.height) / 2);\r\n        if (maxRooms !== undefined) {\r\n          maxRooms--;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _placeRooms(map, maxRooms);\r\n\r\n  _addRoomsToMap(map);\r\n\r\n  _connectNearbyRooms(map);\r\n\r\n  _connectDistantRooms(map);\r\n\r\n  _sortRooms_Id(map.rooms);\r\n\r\n  return map;\r\n}\r\n\r\n/**\r\n * Gets a starting location for the player as far from the first room as possible\r\n * @param {Map} map\r\n */\r\nexport function getPlayerStartingLocation(map) {\r\n  const { width, height, data } = map;\r\n  const visited = [];\r\n  for (let i = 0; i < height; i++) {\r\n    visited.push(new Array(width).fill(0));\r\n  }\r\n  if (map.rooms.length === 0) {\r\n    return { x: 1, y: 1 };\r\n  }\r\n  const bossRoom = map.rooms[0];\r\n  let x = Math.floor(bossRoom.x + bossRoom.width / 2);\r\n  let y = Math.floor(bossRoom.y + bossRoom.height / 2);\r\n  let room = 1;\r\n  const q = [];\r\n  q.push({ x, y });\r\n  while (q.length > 0) {\r\n    const size = q.length;\r\n    for (let i = 0; i < size; i++) {\r\n      const top = q.shift();\r\n      room = data[top.y][top.x];\r\n      for (let j = 0; j < 4; j++) {\r\n        const dir = _directions[j];\r\n        if (top.x + dir.x < 0 || top.x + dir.x > width - 1 || top.y + dir.y < 0 || top.y + dir.y > height - 1) {\r\n          continue;\r\n        }\r\n        if (data[top.y + dir.y][top.x + dir.x] !== 0) {\r\n          if (visited[top.y + dir.y][top.x + dir.x] === 0) {\r\n            visited[top.y + dir.y][top.x + dir.x] = 1;\r\n            q.push({ x: top.x + dir.x, y: top.y + dir.y });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  const playerRoom = map.rooms[room - 1];\r\n  x = Math.floor(playerRoom.x + playerRoom.width / 2);\r\n  y = Math.floor(playerRoom.y + playerRoom.height / 2);\r\n  return { x, y };\r\n}\r\n\r\n/**\r\n * Generates rooms that may go into the dungeon\r\n * @param {Map} map\r\n * @param {Options} options\r\n * @returns {number} targetArea\r\n */\r\nfunction _generateRooms(map, options) {\r\n  const { width, height } = map;\r\n  let { goal, minSize, maxSize } = options;\r\n  if (!goal) {\r\n    goal = 0.5;\r\n  }\r\n  if (!minSize) {\r\n    minSize = 3;\r\n  }\r\n  if (!maxSize) {\r\n    maxSize = Math.max(Math.floor(Math.min(width / 4, height / 4)), minSize);\r\n  }\r\n  const roomSize = [];\r\n  let power = 0;\r\n  for (let s = maxSize; s >= minSize; s--) {\r\n    const count = Math.pow(2, power++);\r\n    for (let c = 0; c < count; c++) {\r\n      roomSize.push(s);\r\n    }\r\n  }\r\n\r\n  let rooms = [];\r\n  const targetArea = width * height * goal;\r\n  let area = 0;\r\n  while (area < targetArea) {\r\n    const size = _pickRandom(roomSize);\r\n    const room = { width: size, height: size };\r\n    if (Math.random() > 0.3) {\r\n      if (Math.random() < 0.5) {\r\n        room.width += 2;\r\n      } else {\r\n        room.height += 2;\r\n      }\r\n    }\r\n    rooms.push(room)\r\n    area += room.width * room.height;\r\n  }\r\n  map.rooms = rooms;\r\n  return Math.floor(width * height * Math.min(goal * 1.5, 1.0));\r\n}\r\n\r\n/**\r\n * Generates the zones within the dungeon\r\n * @param {Map} map\r\n * @param {number} count - the number of zones to generate\r\n */\r\nfunction _generateZones(map, count, targetArea) {\r\n  const { width, height } = map;\r\n  const loc = [];\r\n  for (let i = 0; i < count; i++) {\r\n    loc[i] = i;\r\n  }\r\n\r\n  _shuffle(loc);\r\n\r\n  const xStep = Math.floor((width - 2) / count);\r\n  const yStep = Math.floor((height - 2) / count);\r\n\r\n  const zones = [];\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const zone = { x: i * xStep + 1, y: loc[i] * yStep + 1, width: xStep, height: yStep };\r\n    zones.push(zone);\r\n  }\r\n\r\n  let totalArea = 0;\r\n  for (let i = 0; i < count; i++) {\r\n    const zone = zones[i];\r\n    totalArea += zone.width * zone.height;\r\n  }\r\n\r\n  let growth = true;\r\n\r\n  while (totalArea < targetArea && growth) {\r\n    growth = false;\r\n    for (let i = 0; i < count; i++) {\r\n      const dirs = [];\r\n      const zone = zones[i];\r\n      if (zone.y > 1 && _canZoneGrow(zone.x, zone.y - 1, zone.width, zone.height + 1, i, zones)) {\r\n        dirs.push('up');\r\n      }\r\n      if (zone.y + zone.height < height - 2 && _canZoneGrow(zone.x, zone.y, zone.width, zone.height + 1, i, zones)) {\r\n        dirs.push('down');\r\n      }\r\n      if (zone.x > 1 && _canZoneGrow(zone.x - 1, zone.y, zone.width + 1, zone.height, i, zones)) {\r\n        dirs.push('left');\r\n      }\r\n      if (zone.x + zone.width < width - 2 && _canZoneGrow(zone.x, zone.y, zone.width + 1, zone.height, i, zones)) {\r\n        dirs.push('right');\r\n      }\r\n      if (dirs.length > 0) {\r\n        growth = true;\r\n        const dir = _pickRandom(dirs);\r\n        switch (dir) {\r\n          case 'up':\r\n            zone.y--;\r\n            zone.height++;\r\n            totalArea += zone.width;\r\n            break;\r\n          case 'down':\r\n            zone.height++;\r\n            totalArea += zone.width;\r\n            break;\r\n          case 'left':\r\n            zone.x--;\r\n            zone.width++;\r\n            totalArea += zone.height;\r\n            break;\r\n          case 'right':\r\n            zone.width++;\r\n            totalArea += zone.height;\r\n            break;\r\n          default:\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  map.zones = zones;\r\n}\r\n\r\n/**\r\n * Checks if a zone can grow\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {number} w\r\n * @param {number} h\r\n * @param {number} index\r\n * @param {Zone} zone\r\n * @returns {boolean} whether or not the zone can grow\r\n */\r\nfunction _canZoneGrow(x, y, w, h, index, zones) {\r\n  for (let j = 0; j < zones.length; j++) {\r\n    if (j === index) {\r\n      continue;\r\n    }\r\n    if (_doZonesOverlap(x, y, w, h, zones[j])) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Checks if zones overlap\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {number} w\r\n * @param {number} h\r\n * @param {Zone} zone\r\n * @returns {boolean} whether or not the zones overlap\r\n */\r\nfunction _doZonesOverlap(x, y, w, h, zone) {\r\n  if (x >= zone.x + zone.width || zone.x >= x + w) {\r\n    return false;\r\n  }\r\n  if (y >= zone.y + zone.height || zone.y >= y + h) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Places rooms within the zones of a dungeon\r\n * @param {Map} map\r\n * @param {number} maxRooms - the maximum number of rooms to place\r\n */\r\nfunction _placeRoomsByZone(map, maxRooms) {\r\n  const { rooms, zones } = map;\r\n\r\n  let placedRooms = 0;\r\n  for (let zoneIndex = 0; zoneIndex < zones.length; zoneIndex++) {\r\n    let zonedRooms = 0;\r\n    const zone = zones[zoneIndex];\r\n    const roomCount = rooms.length;\r\n    for (let roomIndex = 0; roomIndex < roomCount; roomIndex++) {\r\n      if (maxRooms !== undefined && (placedRooms >= maxRooms || zonedRooms >= Math.floor(maxRooms / zones.length))) {\r\n        break;\r\n      }\r\n      const room = rooms[roomIndex];\r\n      if (room.hasOwnProperty('x') && room.hasOwnProperty('y')) {\r\n        continue;\r\n      }\r\n      const minX = zone.x;\r\n      const maxX = zone.x + zone.width - room.width;\r\n      const minY = zone.y;\r\n      const maxY = zone.y + zone.height - room.height;\r\n      if (maxX < minX || maxY < minY) {\r\n        continue;\r\n      }\r\n      let isPlaced = false;\r\n      for (let t = 0; t < 100; t++) {\r\n        room.x = _range(minX, maxX);\r\n        room.y = _range(minY, maxY);\r\n        let overlap = false;\r\n        for (let j = 0; j < roomCount; j++) {\r\n          if (j === roomIndex || !rooms[j].hasOwnProperty('x') || !rooms[j].hasOwnProperty('y')) {\r\n            continue;\r\n          }\r\n          if (_doRoomsOverlap(room, rooms[j], 1, 1)) {\r\n            overlap = true;\r\n            break;\r\n          }\r\n        }\r\n        if (!overlap) {\r\n          isPlaced = true;\r\n          break;\r\n        }\r\n      }\r\n      if (isPlaced) {\r\n        room.zone = zoneIndex + 1;\r\n        zonedRooms++;\r\n        placedRooms++;\r\n      } else {\r\n        delete room.x;\r\n        delete room.y;\r\n      }\r\n    }\r\n  }\r\n\r\n  return placedRooms;\r\n}\r\n\r\n/**\r\n * Places rooms anywhere in a dungeon\r\n * @param {Map} map\r\n * @param {number} maxRooms - the maximum number of rooms to place\r\n */\r\nfunction _placeRooms(map, maxRooms) {\r\n  const { width, height, rooms } = map;\r\n\r\n  let placedRooms = 0;\r\n  const roomCount = rooms.length;\r\n  for (let i = 0; i < roomCount; i++) {\r\n    if (maxRooms !== undefined && placedRooms === maxRooms) {\r\n      break;\r\n    }\r\n    const room = rooms[i];\r\n    if (room.hasOwnProperty('x') && room.hasOwnProperty('y')) {\r\n      continue;\r\n    }\r\n    let placed = false;\r\n    for (let t = 0; t < 1000; t++) {\r\n      room.x = _range(1, width - room.width - 1);\r\n      room.y = _range(1, height - room.height - 1);\r\n      let overlap = false;\r\n      for (let j = 0; j < roomCount; j++) {\r\n        if (j === i || !rooms[j].hasOwnProperty('x') || !rooms[j].hasOwnProperty('y')) {\r\n          continue;\r\n        }\r\n        if (_doRoomsOverlap(room, rooms[j], room.width >= 7 ? 3 : 1, room.height >= 7 ? 3 : 1)) {\r\n          overlap = true;\r\n          break;\r\n        }\r\n      }\r\n      if (!overlap) {\r\n        placed = true;\r\n        break;\r\n      }\r\n    }\r\n    if (placed) {\r\n      placedRooms++;\r\n    } else {\r\n      delete room.x;\r\n      delete room.y;\r\n    }\r\n  }\r\n\r\n  map.rooms = map.rooms.filter((room) => room.x || room.y);\r\n\r\n  return map.rooms.length;\r\n}\r\n\r\n/**\r\n * Adds rooms to the map\r\n * @param {Map} map\r\n */\r\nfunction _addRoomsToMap(map) {\r\n  const { data, rooms } = map;\r\n\r\n  const roomCount = rooms.length;\r\n\r\n  for (let i = 0; i < roomCount; i++) {\r\n    const room = rooms[i];\r\n    room.id = i + 1;\r\n    for (let h = 0; h < room.height; h++) {\r\n      for (let w = 0; w < room.width; w++) {\r\n        data[room.y + h][room.x + w] = room.id;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Connects nearby rooms together\r\n * @param {Map} map\r\n */\r\nfunction _connectNearbyRooms(map) {\r\n  const { data, rooms } = map;\r\n\r\n  const links = _generateLinks(rooms.length);\r\n\r\n  const roomConnectors = _generateRoomConnectors(map);\r\n\r\n  _sortRoomConnectors(roomConnectors);\r\n\r\n  const roomCount = rooms.length;\r\n  const connectorId = roomCount + 1;\r\n  const conCount = roomConnectors.length;\r\n  let cur;\r\n  let nxt;\r\n  for (cur = 0; cur < conCount; cur = nxt) {\r\n    for (nxt = cur + 1; nxt < conCount; nxt++) {\r\n      if (roomConnectors[nxt].r1 !== roomConnectors[cur].r1 || roomConnectors[nxt].r2 !== roomConnectors[cur].r2) {\r\n        break;\r\n      }\r\n    }\r\n    if (links[roomConnectors[cur].r1] !== links[roomConnectors[cur].r2]) {\r\n      const apl = roomConnectors[Math.floor(cur + (nxt - cur) / 2)];\r\n      const min = Math.min(links[apl.r1], links[apl.r2]);\r\n      const max = Math.max(links[apl.r1], links[apl.r2]);\r\n      links[apl.r1] = min;\r\n      links[apl.r2] = min;\r\n      for (let i = 1; i <= roomCount; i++) {\r\n        if (links[i] === max) {\r\n          links[i] = min;\r\n        }\r\n      }\r\n      data[apl.y][apl.x] = connectorId;\r\n    }\r\n  }\r\n\r\n  for (let i = 0; i < roomCount; i++) {\r\n    const room = rooms[i];\r\n    room.group = links[room.id];\r\n  }\r\n\r\n  map.connected = _isMapConnected(links);\r\n}\r\n\r\n/**\r\n * Generates a list of connectors for nearby rooms\r\n * @param {Map} map\r\n * @returns {RoomConnector[]} room connectors\r\n */\r\nfunction _generateRoomConnectors(map) {\r\n  const { width, height, data } = map;\r\n\r\n  const roomConnectors = [];\r\n\r\n  for (let y = 1; y < height - 1; y++) {\r\n    for (let x = 1; x < width - 1; x++) {\r\n      if (data[y][x] === 0) {\r\n        if (data[y - 1][x] === 0 && data[y + 1][x] === 0 && data[y][x - 1] !== 0 && data[y][x + 1] !== 0) {\r\n          if (data[y][x - 1] < data[y][x + 1]) {\r\n            roomConnectors.push({ x, y, r1: data[y][x - 1], r2: data[y][x + 1] });\r\n          } else if (data[y][x - 1] > data[y][x + 1]) {\r\n            roomConnectors.push({ x, y, r1: data[y][x + 1], r2: data[y][x - 1] });\r\n          }\r\n        } else if (data[y][x - 1] === 0 && data[y][x + 1] === 0 && data[y - 1][x] !== 0 && data[y + 1][x] !== 0) {\r\n          if (data[y - 1][x] < data[y + 1][x]) {\r\n            roomConnectors.push({ x, y, r1: data[y - 1][x], r2: data[y + 1][x] });\r\n          } else if (data[y - 1][x] > data[y + 1][x]) {\r\n            roomConnectors.push({ x, y, r1: data[y + 1][x], r2: data[y - 1][x] });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  return roomConnectors;\r\n}\r\n\r\n/**\r\n * Connects distant rooms together\r\n * @param {Map} map\r\n */\r\nfunction _connectDistantRooms(map) {\r\n  const { data, rooms } = map;\r\n\r\n  _sortRooms_GroupAndId(rooms);\r\n\r\n  const groupCount = _renumberGroups(rooms);\r\n\r\n  if (groupCount === 1) {\r\n    return;\r\n  }\r\n\r\n  const groupConnectors = _generateGroupConnectors(rooms);\r\n\r\n  _sortGroupConnectors(groupConnectors);\r\n\r\n  const groupLinks = _generateLinks(groupCount);\r\n\r\n  const connectorId = rooms.length + 1;\r\n\r\n  for (let i = 0; i < groupConnectors.length; i++) {\r\n    const groupConnector = groupConnectors[i];\r\n    if (groupLinks[groupConnector.g1] !== groupLinks[groupConnector.g2]) {\r\n      const min = Math.min(groupLinks[groupConnector.g1], groupLinks[groupConnector.g2]);\r\n      const max = Math.max(groupLinks[groupConnector.g1], groupLinks[groupConnector.g2]);\r\n      groupLinks[groupConnector.g1] = min;\r\n      groupLinks[groupConnector.g2] = min;\r\n      for (let i = 1; i <= groupCount; i++) {\r\n        if (groupLinks[i] === max) {\r\n          groupLinks[i] = min;\r\n        }\r\n      }\r\n\r\n      const { x, y, distance, horizontal } = groupConnector;\r\n\r\n      if (horizontal) {\r\n        for (let o = 0; o < distance; o++) {\r\n          data[y][x + o] = connectorId;\r\n        }\r\n      } else {\r\n        for (let o = 0; o < distance; o++) {\r\n          data[y + o][x] = connectorId;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  map.connected = _isMapConnected(groupLinks);\r\n}\r\n\r\n/**\r\n * Generates a list of links that link to themselves\r\n * @param {number} count\r\n * @returns {number[]} links\r\n */\r\nfunction _generateLinks(count) {\r\n  const links = [];\r\n  for (let i = 0; i <= count; i++) {\r\n    links.push(i);\r\n  }\r\n  return links;\r\n}\r\n\r\nfunction _isMapConnected(links) {\r\n  for (let i = 1; i < links.length; i++) {\r\n    if (links[i] !== 1) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Renumbers the groups contiguously statrting at 1\r\n * @param {Room[]} rooms\r\n * @returns {number} number of groups\r\n */\r\nfunction _renumberGroups(rooms) {\r\n  const roomCount = rooms.length;\r\n\r\n  let groupCount = 0;\r\n\r\n  let cur;\r\n  let nxt;\r\n  for (cur = 0; cur < roomCount; cur = nxt) {\r\n    for (nxt = cur + 1; nxt < roomCount; nxt++) {\r\n      if (rooms[nxt].group !== rooms[cur].group) {\r\n        break;\r\n      }\r\n    }\r\n    groupCount++;\r\n    for (let apl = cur; apl < nxt; apl++) {\r\n      rooms[apl].group = groupCount;\r\n    }\r\n  }\r\n\r\n  return groupCount;\r\n}\r\n\r\n/**\r\n * Generates a list of connectors across different groups\r\n * @param {Room[]} rooms\r\n * @returns {GrouConnector[]} group connectors\r\n */\r\nfunction _generateGroupConnectors(rooms) {\r\n  const roomCount = rooms.length;\r\n\r\n  const roomInfoList = {};\r\n\r\n  for (let i = 0; i < roomCount; i++) {\r\n    for (let j = i + 1; j < roomCount; j++) {\r\n      if (rooms[i].group === rooms[j].group) {\r\n        continue;\r\n      }\r\n\r\n      const alignmentAndDistance = _getAlignmentAndDistance(rooms[i], rooms[j]);\r\n\r\n      if (!alignmentAndDistance) {\r\n        continue;\r\n      }\r\n\r\n      const { alignment, distance, x, y, horizontal } = alignmentAndDistance;\r\n\r\n      if (alignment === 0) {\r\n        continue;\r\n      }\r\n\r\n      const g1 = rooms[i].group;\r\n      const g2 = rooms[j].group;\r\n      const key = g1 + '_' + g2;\r\n\r\n      if (!roomInfoList[key]) {\r\n        roomInfoList[key] = { distance, g1, g2, room1: rooms[i].id, room2: rooms[j].id, alignment, x, y, horizontal };\r\n      } else if (roomInfoList[key].distance > distance || (roomInfoList[key].distance === distance && roomInfoList[key].alignment < alignmentAndDistance)) {\r\n        roomInfoList[key] = { distance, g1, g2, room1: rooms[i].id, room2: rooms[j].id, alignment, x, y, horizontal };\r\n      }\r\n    }\r\n  }\r\n\r\n  const groupConnectors = [];\r\n\r\n  for (let prop in roomInfoList) {\r\n    if (roomInfoList.hasOwnProperty(prop)) {\r\n      groupConnectors.push(roomInfoList[prop]);\r\n    }\r\n  }\r\n\r\n  return groupConnectors;\r\n}\r\n\r\n/**\r\n * Returns a random number within a range\r\n * @param {number} min\r\n * @param {number} max\r\n */\r\nfunction _range(min, max) {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\n/**\r\n * Picks a random element from an array\r\n * @param {*[]} data\r\n */\r\nfunction _pickRandom(data) {\r\n  return data[Math.floor(Math.random() * data.length)];\r\n}\r\n\r\n/**\r\n * Shuffles the elements in an array\r\n * @param {*[]} data\r\n */\r\nfunction _shuffle(data) {\r\n  const n = data.length;\r\n  for (let i = n - 1; i > 0; i--) {\r\n    const j = Math.floor(Math.random() * (i + 1));\r\n    const t = data[i];\r\n    data[i] = data[j];\r\n    data[j] = t;\r\n  }\r\n}\r\n\r\n/**\r\n * Shuffles the elements in an array\r\n * @param {*[]} data\r\n */\r\nfunction _sortRooms_LargestToSmallest(rooms) {\r\n  rooms.sort((pri, sec) => {\r\n    const priArea = pri.width * pri.height;\r\n    const secArea = sec.width * sec.height;\r\n    if (priArea < secArea) {\r\n      return 1;\r\n    } else if (priArea > secArea) {\r\n      return -1;\r\n    }\r\n    return 0;\r\n  });\r\n}\r\n\r\n/**\r\n * Sorts rooms by group and id\r\n * @param {Room[]} rooms\r\n */\r\nfunction _sortRooms_GroupAndId(rooms) {\r\n  rooms.sort((pri, sec) => {\r\n    if (pri.group < sec.group) {\r\n      return -1;\r\n    } else if (pri.group > sec.group) {\r\n      return 1;\r\n    }\r\n    if (pri.id < sec.id) {\r\n      return -1;\r\n    } else if (pri.id > sec.id) {\r\n      return 1;\r\n    }\r\n    return 0;\r\n  });\r\n}\r\n\r\n/**\r\n * Sorts rooms by id\r\n * @param {Room[]} rooms\r\n */\r\nfunction _sortRooms_Id(rooms) {\r\n  rooms.sort((pri, sec) => {\r\n    if (pri.id < sec.id) {\r\n      return -1;\r\n    } else if (pri.id > sec.id) {\r\n      return 1;\r\n    }\r\n    return 0;\r\n  });\r\n}\r\n\r\n/**\r\n * Sorts room connectors by regions and location\r\n * @param {RoomConnector[]} connectors\r\n */\r\nfunction _sortRoomConnectors(connectors) {\r\n  connectors.sort((pri, sec) => {\r\n    if (pri.r1 < sec.r1) { return -1; }\r\n    else if (pri.r1 > sec.r1) { return 1; }\r\n    if (pri.r2 < sec.r2) { return -1; }\r\n    else if (pri.r2 > sec.r2) { return 1; }\r\n    if (pri.x < sec.x) { return -1; }\r\n    else if (pri.x > sec.x) { return 1; }\r\n    if (pri.y < sec.y) { return -1; }\r\n    else if (pri.y > sec.y) { return 1; }\r\n    return 0;\r\n  });\r\n}\r\n\r\n/**\r\n * Sorts group connectors by distance and alignment\r\n * @param {GroupConnector[]} connectors\r\n */\r\nfunction _sortGroupConnectors(connectors) {\r\n  connectors.sort((pri, sec) => {\r\n    if (pri.distance < sec.distance) { return -1; }\r\n    else if (pri.distance > sec.distance) { return 1; }\r\n    if (pri.alignment < sec.alignment) { return -1; }\r\n    else if (pri.alignment > sec.alignment) { return 1; }\r\n    return 0;\r\n  });\r\n}\r\n\r\n/**\r\n * Checks if rooms overlap (including a border)\r\n * @param {Room} room1\r\n * @param {Room} room2\r\n * @param {number} borderX - x border width\r\n * @param {number} borderY - y border width\r\n * @returns {boolean} whether or not the rooms overlap\r\n */\r\nfunction _doRoomsOverlap(room1, room2, borderX, borderY) {\r\n  if (room1.x >= room2.x + room2.width + borderX || room2.x >= room1.x + room1.width + borderX) {\r\n    return false;\r\n  }\r\n  if (room1.y >= room2.y + room2.height + borderY || room2.y >= room1.y + room1.height + borderY) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Gets the alignment and distance between rooms\r\n * @param {Room} room1\r\n * @param {Room} room2\r\n * @returns {AlignmentDistance} the alignment, distance, and whether or not the alignment is horizontal\r\n */\r\nfunction _getAlignmentAndDistance(room1, room2) {\r\n  if (room1.y > room2.y + room2.height || room2.y > room1.y + room1.height) {\r\n    if (room1.x > room2.x + room2.width || room2.x > room1.x + room1.width) {\r\n      return null;\r\n    } else {\r\n      let y;\r\n      let distance;\r\n      if (room1.y > room2.y + room2.height) {\r\n        y = room2.y + room2.height\r\n        distance = room1.y - y;\r\n      } else {\r\n        y = room1.y + room1.height;\r\n        distance = room2.y - y;\r\n      }\r\n      const max = Math.min(room1.x + room1.width, room2.x + room2.width);\r\n      const min = Math.max(room1.x, room2.x)\r\n      const x = Math.floor((min + max) / 2);\r\n      return { alignment: max - min, distance, x, y, horizontal: false };\r\n    }\r\n  } else {\r\n    if (room1.x > room2.x + room2.width || room2.x > room1.x + room1.width) {\r\n      let x\r\n      let distance;\r\n      if (room1.x > room2.x + room2.width) {\r\n        x = room2.x + room2.width;\r\n        distance = room1.x - x;\r\n      } else {\r\n        x = room1.x + room1.width;\r\n        distance = room2.x - x;\r\n      }\r\n      const max = Math.min(room1.y + room1.height, room2.y + room2.height);\r\n      const min = Math.max(room1.y, room2.y)\r\n      const y = Math.floor((min + max) / 2);\r\n      return { alignment: max - min, distance, x, y, horizontal: true };\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","/** \r\n * @fileOverview Drawing logic\r\n */\r\n\r\n/**\r\n * Resizes the viewport to match the bouding rectangle\r\n * @param {HTMLCanvasElement} canvas\r\n */\r\nexport function resizeViewport(canvas) {\r\n  const rect = canvas.getBoundingClientRect()\r\n  canvas.width = rect.width;\r\n  canvas.height = rect.height;\r\n}\r\n\r\n/**\r\n * Draws the map and the player\r\n * @param {HTMLCanvasElement} canvas\r\n * @param {Map} map\r\n * @param {Player} player\r\n */\r\nexport function drawMap(canvas, map, player) {\r\n  const { width, height, data, rooms, zones } = map;\r\n  const ctx = canvas.getContext('2d');\r\n  ctx.fillStyle = '#000000';\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n  const cellWidth = Math.floor(canvas.width / width);\r\n  const cellHeight = Math.floor(canvas.height / height);\r\n  const xOffset = Math.floor((canvas.width - width * cellWidth) / 2);\r\n  const yOffset = Math.floor((canvas.height - height * cellHeight) / 2);\r\n  const colors = ['#7F0000', '#007F00', '#00007F', '#7F7F00', '#7F007F', '#007F7F', '#7F3F3F', '#3F7F3F', '#3F3F7F', '#7F7F3F', '#7F3F7F', '#3F7F7F'];\r\n\r\n  if (zones) {\r\n    for (let i = 0; i < zones.length; i++) {\r\n      const zone = zones[i];\r\n      ctx.fillStyle = colors[i % colors.length];\r\n      for (let y = 0; y < zone.height; y++) {\r\n        for (let x = 0; x < zone.width; x++) {\r\n          ctx.fillRect(xOffset + (zone.x + x) * cellWidth + Math.floor((cellWidth - 4) / 2), yOffset + (zone.y + y) * cellHeight + Math.floor((cellHeight - 4) / 2), 4, 4);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  for (let y = 0; y < height; y++) {\r\n    for (let x = 0; x < width; x++) {\r\n      if (data[y][x] !== 0) {\r\n        let room = undefined;\r\n        if (data[y][x] <= rooms.length) {\r\n          room = rooms[data[y][x] - 1];\r\n          if (room.group) {\r\n            ctx.fillStyle = colors[(room.group - 1) % colors.length];\r\n          } else {\r\n            ctx.fillStyle = '#3F3F3F';\r\n          }\r\n        } else {\r\n          ctx.fillStyle = '#3F3F3F';\r\n        }\r\n        ctx.fillRect(xOffset + x * cellWidth + 1, yOffset + y * cellHeight + 1, cellWidth - 2, cellHeight - 2);\r\n        ctx.fillStyle = '#FFFFFF';\r\n        ctx.font = '8px monospace';\r\n        ctx.textAlign = 'center';\r\n        ctx.textBaseline = 'middle';\r\n        if (room && room.zone) {\r\n          ctx.fillText(data[y][x].toString(), xOffset + x * cellWidth + cellWidth / 2, yOffset + y * cellHeight + cellHeight / 4);\r\n          ctx.fillText(room.zone.toString(), xOffset + x * cellWidth + cellWidth / 2, yOffset + y * cellHeight + cellHeight * 3 / 4);\r\n        } else {\r\n          ctx.fillText(data[y][x].toString(), xOffset + x * cellWidth + cellWidth / 2, yOffset + y * cellHeight + cellHeight / 2);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const boss = {\r\n    x: Math.floor(rooms[0].x + rooms[0].width / 2),\r\n    y: Math.floor(rooms[0].y + rooms[0].height / 2)\r\n  };\r\n\r\n  ctx.fillStyle = '#FFFFFF';\r\n  ctx.font = '50px monospace';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n  ctx.fillText('O', xOffset + boss.x * cellWidth + cellWidth / 2, yOffset + boss.y * cellHeight + cellHeight / 2);\r\n\r\n  ctx.fillStyle = '#FFFFFF';\r\n  ctx.font = '50px monospace';\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n  ctx.fillText('X', xOffset + player.x * cellWidth + cellWidth / 2, yOffset + player.y * cellHeight + cellHeight / 2);\r\n}\r\n","import React from 'react';\r\nimport Controls from './Controls';\r\nimport { generateDungeon, getPlayerStartingLocation } from '../lib/map';\r\nimport { resizeViewport, drawMap } from '../lib/draw';\r\n\r\n// Take Home Projects - Build a Roguelike Dungeon Crawler Game\r\n// Objective: Build a CodePen.io app that is functionally similar to this: https://codepen.io/freeCodeCamp/full/apLXEJ/.\r\n// Fulfill the below user stories. Use whichever libraries or APIs you need. Give it your own personal style.\r\n// User Story: I have health, a level, and a weapon. I can pick up a better weapon. I can pick up health items.\r\n// User Story: All the items and enemies on the map are arranged at random.\r\n// User Story: I can move throughout a map, discovering items.\r\n// User Story: I can move anywhere within the map's boundaries, but I can't move through an enemy until I've beaten it.\r\n// User Story: Much of the map is hidden. When I take a step, all spaces that are within a certain number of spaces from me are revealed.\r\n// User Story: When I beat an enemy, the enemy goes away and I get XP, which eventually increases my level.\r\n// User Story: When I fight an enemy, we take turns damaging each other until one of us loses. I do damage based off of my level and my weapon. The enemy does damage based off of its level. Damage is somewhat random within a range.\r\n// User Story: When I find and beat the boss, I win.\r\n// User Story: The game should be challenging, but theoretically winnable.\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.onResize = this.onResize.bind(this);\r\n    this.onKeyDown = this.onKeyDown.bind(this);\r\n    this.onKeyUp = this.onKeyUp.bind(this);\r\n    this.onAnimationFrame = this.onAnimationFrame.bind(this);\r\n    this.onClickPrevious = this.onClickPrevious.bind(this);\r\n    this.onClickNext = this.onClickNext.bind(this);\r\n    this.onChange = this.onChange.bind(this);\r\n    this.updateMap = this.updateMap.bind(this);\r\n    this.keys = {};\r\n    const mapOptions = {\r\n      width: 112,\r\n      height: 63,\r\n      goal: 0.25,\r\n      zones: 6,\r\n      minSize: 4,\r\n      maxSize: 12,\r\n      maxRooms: 30,\r\n      bossRoom: true\r\n    };\r\n    this.state = {\r\n      showControls: false,\r\n      mode: 0,\r\n      modes: ['Map Mode', 'Explore Mode'],\r\n      mapOptions,\r\n      options: [\r\n        [\r\n          {\r\n            name: 'Update Map',\r\n            type: 'function',\r\n            function: this.updateMap\r\n          },\r\n          {\r\n            name: 'Map Width',\r\n            type: 'int',\r\n            id: 'width',\r\n            min: 10,\r\n            max: 200,\r\n            value: mapOptions.width\r\n          },\r\n          {\r\n            name: 'Map Height',\r\n            type: 'int',\r\n            id: 'height',\r\n            min: 10,\r\n            max: 100,\r\n            value: mapOptions.height\r\n          },\r\n          {\r\n            name: 'Room Fraction',\r\n            type: 'float',\r\n            id: 'goal',\r\n            min: 0.0,\r\n            max: 1.0,\r\n            value: mapOptions.goal\r\n          },\r\n          {\r\n            name: 'Min Room Size',\r\n            type: 'int',\r\n            id: 'minSize',\r\n            min: 2,\r\n            max: 8,\r\n            value: mapOptions.minSize\r\n          },\r\n          {\r\n            name: 'Max Room Size',\r\n            type: 'int',\r\n            id: 'maxSize',\r\n            min: 8,\r\n            max: 14,\r\n            value: mapOptions.maxSize\r\n          },\r\n          {\r\n            name: 'Max Rooms',\r\n            type: 'int',\r\n            id: 'maxRooms',\r\n            min: 0,\r\n            max: 100,\r\n            value: mapOptions.maxRooms\r\n          },\r\n          {\r\n            name: 'Zones',\r\n            type: 'int',\r\n            id: 'zones',\r\n            min: 0,\r\n            max: 20,\r\n            value: mapOptions.zones\r\n          },\r\n          {\r\n            name: 'Boss Room',\r\n            type: 'bool',\r\n            id: 'bossRoom',\r\n            value: mapOptions.bossRoom\r\n          }\r\n        ],\r\n        []\r\n      ]\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    resizeViewport(this.canvas);\r\n    this.updateMap();\r\n    window.addEventListener('resize', this.onResize);\r\n    window.addEventListener('keydown', this.onKeyDown);\r\n    window.addEventListener('keyup', this.onKeyUp);\r\n    this.frame = window.requestAnimationFrame(this.onAnimationFrame);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    window.removeEventListener('resize', this.onResize);\r\n    window.removeEventListener('keydown', this.onKeyDown);\r\n    window.removeEventListener('keyup', this.onKeyUp);\r\n    window.cancelAnimationFrame(this.frame);\r\n  }\r\n\r\n  onResize() {\r\n    resizeViewport(this.canvas);\r\n  }\r\n\r\n  onKeyDown(event) {\r\n    event.preventDefault();\r\n    if (!this.keys[event.key]) {\r\n      this.onKeyPress(event.key);\r\n      this.keys[event.key] = true;\r\n      if (this.captureKeys) {\r\n        this.state.scene.keyboardState(this.keys);\r\n      }\r\n    }\r\n  }\r\n\r\n  onKeyUp(event) {\r\n    event.preventDefault();\r\n    this.keys[event.key] = false;\r\n    if (this.captureKeys) {\r\n      this.state.scene.keyboardState(this.keys);\r\n    }\r\n  }\r\n\r\n  onKeyPress(key) {\r\n    const { map, player } = this.state;\r\n    if (key === 'Escape') {\r\n      this.setState({\r\n        showControls: !this.state.showControls\r\n      });\r\n    }\r\n    let dx = 0;\r\n    let dy = 0;\r\n    if (key === 'ArrowUp') {\r\n      dy = -1;\r\n    } else if (key === 'ArrowDown') {\r\n      dy = 1;\r\n    } else if (key === 'ArrowLeft') {\r\n      dx = -1;\r\n    } else if (key === 'ArrowRight') {\r\n      dx = 1;\r\n    }\r\n    if (dx !== 0 || dy !== 0) {\r\n      if (map.data[player.y + dy][player.x + dx] !== 0) {\r\n        this.setState({\r\n          player: {\r\n            x: player.x + dx,\r\n            y: player.y + dy\r\n          }\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  onCloseMenu() {\r\n    this.setState({\r\n      showControls: false\r\n    });\r\n  }\r\n\r\n  onAnimationFrame() {\r\n    if (this.state && this.state.map) {\r\n      drawMap(this.canvas, this.state.map, this.state.player);\r\n    }\r\n    this.frame = window.requestAnimationFrame(this.onAnimationFrame);\r\n  }\r\n\r\n  onClickNext() {\r\n    this.setState({ mode: (this.state.mode + 1) % this.state.modes.length });\r\n  }\r\n\r\n  onClickPrevious() {\r\n    this.setState({ mode: (this.state.mode + this.state.modes.length - 1) % this.state.modes.length });\r\n  }\r\n\r\n  onChange(option, value) {\r\n    if (value !== option.value) {\r\n      this.setOption(option, value);\r\n    }\r\n  }\r\n\r\n  setOption(option, value) {\r\n    option.value = value;\r\n    if (option.id) {\r\n      const mapOptions = Object.assign({}, this.state.mapOptions);\r\n      mapOptions[option.id] = value;\r\n      this.setState({ mapOptions });\r\n    }\r\n  }\r\n\r\n  updateMap() {\r\n    const map = generateDungeon(this.state.mapOptions);\r\n    const player = getPlayerStartingLocation(map);\r\n    this.setState({\r\n      map,\r\n      player\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div id=\"screen\">\r\n        <canvas id=\"canvas\" ref={elem => this.canvas = elem} onClick={this.onClick}></canvas>\r\n        <Controls show={this.state.showControls} title={this.state.modes[this.state.mode]} options={this.state.options[this.state.mode]} onClickPrevious={this.onClickPrevious} onClickNext={this.onClickNext} onChange={this.onChange} />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}