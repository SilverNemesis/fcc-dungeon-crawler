(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(t,e,r){},15:function(t,e,r){"use strict";r.r(e);var i=r(0),n=r.n(i),a=r(3),o=r.n(a),h=(r(14),r(4)),s=r(5),l=r(7),f=r(6),y=r(1),d=r(8),u=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];function c(t){for(var e=t.width,r=t.height,i=t.zones,n=[],a=0;a<r;a++)n.push(new Array(e).fill(0));var o={width:e,height:r,data:n};return function(t,e){var r=t.width,i=t.height,n=e.goal,a=e.minSize,o=e.maxSize;n||(n=.5);a||(a=3);o||(o=g(Math.max(Math.floor(Math.min(r/4,i/4)),a)));for(var h=[],s=0,l=o;l>=a;l-=2)for(var f=Math.pow(2,s++),y=0;y<f;y++)h.push(l);var d=[],u=r*i*n,c=0;for(;c<u;){var v=m(h),w={width:v,height:v};Math.random()>.3&&(Math.random()<.5?w.width+=2:w.height+=2),d.push(w),c+=w.width*w.height}t.rooms=d}(o,t),i&&i>1&&(function(t,e){for(var r=t.width,i=t.height,n=[],a=0;a<e;a++)n[a]=a;!function(t){for(var e=t.length-1;e>=0;e--){var r=Math.floor(Math.random()*e),i=t[e];t[e]=t[r],t[r]=i}}(n);for(var o=Math.floor((r-2)/e),h=Math.floor((i-2)/e),s=[],l=0;l<e;l++){var f={x:l*o+1,y:n[l]*h+1,width:o,height:h};s.push(f)}t.zones=s}(o,i),function(t){var e=t.width,r=t.height,i=t.rooms,n=t.zones;w(i);for(var a=0,o=i.length,h=0;h<o;h++){var s=i[h],l=n[a].x,f=Math.min(n[a].x+n[a].width,e-s.width-1),y=n[a].y,d=Math.min(n[a].y+n[a].height,r-s.height-1);if(!(l+s.width>e-1||y+s.height>r-1)){for(var u=!1,c=0;c<100;c++){s.x=g(v(l,f)),s.y=g(v(y,d));for(var m=!1,p=0;p<o;p++)if(p!==h&&i[p].hasOwnProperty("x")&&i[p].hasOwnProperty("y")&&x(s,i[p],1,1)){m=!0;break}if(!m){u=!0;break}}u?a=(a+1)%n.length:(delete s.x,delete s.y)}}}(o)),function(t){var e=t.width,r=t.height,i=t.rooms;w(i);for(var n=i.length,a=0;a<n;a++){var o=i[a];if(!o.hasOwnProperty("x")||!o.hasOwnProperty("y")){for(var h=!1,s=0;s<1e3;s++){o.x=g(v(1,e-o.width-1)),o.y=g(v(1,r-o.height-1));for(var l=!1,f=0;f<n;f++)if(f!==a&&i[f].hasOwnProperty("x")&&i[f].hasOwnProperty("y")&&x(o,i[f],o.width>=7?3:1,o.height>=7?3:1)){l=!0;break}if(!l){h=!0;break}}h||(delete o.x,delete o.y)}}t.rooms=t.rooms.filter((function(t){return t.x||t.y}))}(o),function(t){for(var e=t.width,r=t.height,i=t.data,n=t.rooms,a=n.length,o=0;o<a;o++)for(var h=n[o],s=0;s<h.height;s++)for(var l=0;l<h.width;l++)i[h.y+s][h.x+l]=o+1;for(var f=[],y=0;y<=a;y++)f.push(y);for(var d=[],u=1;u<r-1;u++)for(var c=1;c<e-1;c++)0===i[u][c]&&(0===i[u-1][c]&&0===i[u+1][c]&&0!==i[u][c-1]&&0!==i[u][c+1]?i[u][c-1]<i[u][c+1]?d.push({x:c,y:u,r1:i[u][c-1],r2:i[u][c+1]}):i[u][c-1]>i[u][c+1]&&d.push({x:c,y:u,r1:i[u][c+1],r2:i[u][c-1]}):0===i[u][c-1]&&0===i[u][c+1]&&0!==i[u-1][c]&&0!==i[u+1][c]&&(i[u-1][c]<i[u+1][c]?d.push({x:c,y:u,r1:i[u-1][c],r2:i[u+1][c]}):i[u-1][c]>i[u+1][c]&&d.push({x:c,y:u,r1:i[u+1][c],r2:i[u-1][c]})));v=d,v.sort((function(t,e){return t.r1<e.r1?-1:t.r1>e.r1?1:t.r2<e.r2?-1:t.r2>e.r2?1:t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}));var v;var g,m,w=d.length;for(g=0;g<w;g=m){for(m=g+1;m<w&&(d[m].r1===d[g].r1&&d[m].r2===d[g].r2);m++);if(f[d[g].r1]!==f[d[g].r2]){var x=d[Math.floor(g+(m-g)/2)],p=Math.min(f[x.r1],f[x.r2]),F=Math.max(f[x.r1],f[x.r2]);f[x.r1]=p,f[x.r2]=p;for(var k=1;k<=a;k++)f[k]===F&&(f[k]=p);i[x.y][x.x]=a+1}}for(var M=0;M<a;M++){var z=n[M];z.id=M+1,z.group=f[z.id]}}(o),function(t){var e=t.data,r=t.rooms,i=r.length;!function(t){t.sort((function(t,e){return t.group<e.group?-1:t.group>e.group?1:t.id<e.id?-1:t.id>e.id?1:0}))}(r);var n,a,o=0;for(n=0;n<i;n=a){for(a=n+1;a<i&&r[a].group===r[n].group;a++);o++;for(var h=n;h<a;h++)r[h].group=o}for(var s={},l=0;l<i;l++)for(var f=l+1;f<i;f++)if(r[l].group!==r[f].group){var y=p(r[l],r[f]);if(y){var d=y.alignment,u=y.distance,c=y.x,v=y.y,g=y.horizontal;if(0!==d){var m=r[l].group,w=r[f].group,x=m+"_"+w;s[x]?(s[x].distance>u||s[x].distance===u&&s[x].alignment<y)&&(s[x]={distance:u,g1:m,g2:w,room1:r[l].id,room2:r[f].id,alignment:d,x:c,y:v,horizontal:g}):s[x]={distance:u,g1:m,g2:w,room1:r[l].id,room2:r[f].id,alignment:d,x:c,y:v,horizontal:g}}}}var F=[];for(var k in s)s.hasOwnProperty(k)&&F.push(s[k]);M=F,M.sort((function(t,e){return t.distance<e.distance?-1:t.distance>e.distance?1:t.alignment<e.alignment?-1:t.alignment>e.alignment?1:0}));var M;for(var z=[],b=0;b<=o;b++)z.push(b);for(var O=0;O<F.length;O++){var S=F[O];if(z[S.g1]!==z[S.g2]){var A=Math.min(z[S.g1],z[S.g2]),E=Math.max(z[S.g1],z[S.g2]);z[S.g1]=A,z[S.g2]=A;for(var K=1;K<=o;K++)z[K]===E&&(z[K]=A);var P=S.x,j=S.y,D=S.distance;if(S.horizontal)for(var R=0;R<D;R++)e[j][P+R]=i+1;else for(var _=0;_<D;_++)e[j+_][P]=i+1}}(function(t){t.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:0}))})(r),t.connected=!0;for(var C=1;C<=o;C++)if(1!==z[C]){t.connected=!1;break}}(o),o}function v(t,e){return Math.floor(Math.random()*(e-t+1))+t}function g(t){return 2*Math.floor(t/2)+1}function m(t){return t[Math.floor(Math.random()*t.length)]}function w(t){t.sort((function(t,e){var r=t.width*t.height,i=e.width*e.height;return r<i?1:r>i?-1:0}))}function x(t,e,r,i){return!(t.x>=e.x+e.width+r||e.x>=t.x+t.width+r)&&!(t.y>=e.y+e.height+i||e.y>=t.y+t.height+i)}function p(t,e){if(t.y>e.y+e.height||e.y>t.y+t.height){if(t.x>e.x+e.width||e.x>t.x+t.width)return null;var r,i;t.y>e.y+e.height?(r=e.y+e.height,i=t.y-r):(r=t.y+t.height,i=e.y-r);var n=Math.min(t.x+t.width,e.x+e.width),a=Math.max(t.x,e.x);return{alignment:n-a,distance:i,x:Math.floor((a+n)/2),y:r,horizontal:!1}}if(t.x>e.x+e.width||e.x>t.x+t.width){var o,h;t.x>e.x+e.width?(o=e.x+e.width,h=t.x-o):(o=t.x+t.width,h=e.x-o);var s=Math.min(t.y+t.height,e.y+e.height),l=Math.max(t.y,e.y);return{alignment:s-l,distance:h,x:o,y:Math.floor((l+s)/2),horizontal:!0}}return null}var F=function(t){function e(t){var r;return Object(h.a)(this,e),(r=Object(l.a)(this,Object(f.a)(e).call(this,t))).onResize=r.onResize.bind(Object(y.a)(r)),r.onKeyDown=r.onKeyDown.bind(Object(y.a)(r)),r.onKeyUp=r.onKeyUp.bind(Object(y.a)(r)),r.onAnimationFrame=r.onAnimationFrame.bind(Object(y.a)(r)),r.onClick=r.onClick.bind(Object(y.a)(r)),r.keys={},r.state={showOverlay:!1},r}return Object(d.a)(e,t),Object(s.a)(e,[{key:"componentDidMount",value:function(){this._resizeViewport(),this._updateMap(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){this._resizeViewport()}},{key:"onKeyDown",value:function(t){t.preventDefault(),this.keys[t.key]||(this.onKeyPress(t.key),this.keys[t.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(t){t.preventDefault(),this.keys[t.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(t){var e=this.state,r=e.map,i=e.player;"Escape"===t&&this.setState({showOverlay:!this.state.showOverlay});var n=0,a=0;"ArrowUp"===t?a=-1:"ArrowDown"===t?a=1:"ArrowLeft"===t?n=-1:"ArrowRight"===t&&(n=1),0===n&&0===a||0!==r.data[i.y+a][i.x+n]&&this.setState({player:{x:i.x+n,y:i.y+a}})}},{key:"onAnimationFrame",value:function(){this._drawMap(),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClick",value:function(){this._updateMap()}},{key:"_resizeViewport",value:function(){var t=this.canvas,e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}},{key:"_updateMap",value:function(){var t=c({width:107,height:55,goal:.25,zones:20,minSize:3,maxSize:7}),e=function(t){for(var e=t.width,r=t.height,i=t.data,n=[],a=0;a<r;a++)n.push(new Array(e).fill(0));if(0===t.rooms.length)return{x:1,y:1};var o=t.rooms[0],h=Math.floor(o.x+o.width/2),s=Math.floor(o.y+o.height/2),l=1,f=[];for(f.push({x:h,y:s});f.length>0;)for(var y=f.length,d=0;d<y;d++){var c=f.shift();l=i[c.y][c.x];for(var v=0;v<4;v++){var g=u[v];c.x+g.x<0||c.x+g.x>e-1||c.y+g.y<0||c.y+g.y>r-1||0!==i[c.y+g.y][c.x+g.x]&&0===n[c.y+g.y][c.x+g.x]&&(n[c.y+g.y][c.x+g.x]=1,f.push({x:c.x+g.x,y:c.y+g.y}))}}var m=t.rooms[l-1];return{x:h=Math.floor(m.x+m.width/2),y:s=Math.floor(m.y+m.height/2)}}(t);this.setState({map:t,player:e})}},{key:"_drawMap",value:function(){if(this.state&&this.state.map){var t=this.state.map,e=t.width,r=t.height,i=t.data,n=t.rooms,a=this.state.player,o=this.canvas.getContext("2d");o.fillStyle="#000000",o.fillRect(0,0,this.canvas.width,this.canvas.height);for(var h=Math.floor(this.canvas.width/e),s=Math.floor(this.canvas.height/r),l=Math.floor((this.canvas.width-e*h)/2),f=Math.floor((this.canvas.height-r*s)/2),y=["#7F0000","#007F00","#00007F","#7F7F00","#7F007F","#007F7F","#7F3F3F","#3F7F3F","#3F3F7F","#7F7F3F","#7F3F7F","#3F7F7F"],d=0;d<r;d++)for(var u=0;u<e;u++)if(0!==i[d][u]){if(i[d][u]<=n.length){var c=n[i[d][u]-1];c.group?o.fillStyle=y[(c.group-1)%y.length]:o.fillStyle="#3F3F3F"}else o.fillStyle="#3F3F3F";o.fillRect(l+u*h+1,f+d*s+1,h-2,s-2),o.fillStyle="#FFFFFF",o.font="8px monospace",o.textAlign="center",o.textBaseline="middle",o.fillText(i[d][u].toString(),l+u*h+h/2,f+d*s+s/2)}o.fillStyle="#7F7FFF",o.beginPath(),o.arc(l+a.x*h+h/2,f+a.y*s+s/2,Math.min(h/4,s/4)-1,0,2*Math.PI),o.fill()}}},{key:"render",value:function(){var t=this,e=null;this.state&&this.state.map&&this.state.map.zones&&(e=this.state.map.zones.map((function(t,e){return n.a.createElement("div",{key:e},JSON.stringify(t,null,2))})));var r=null;return this.state&&this.state.map&&this.state.map.rooms&&(r=this.state.map.rooms.map((function(t,e){return n.a.createElement("div",{key:e},JSON.stringify(t,null,2))}))),n.a.createElement("div",{id:"screen"},n.a.createElement("canvas",{id:"canvas",ref:function(e){return t.canvas=e},onClick:this.onClick}),n.a.createElement("div",{id:"overlay",hidden:!this.state.showOverlay},e,r))}}]),e}(n.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},9:function(t,e,r){t.exports=r(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.2352c722.chunk.js.map