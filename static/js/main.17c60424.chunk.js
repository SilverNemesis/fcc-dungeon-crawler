(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(3),o=n.n(a),h=(n(14),n(4)),s=n(5),c=n(7),f=n(6),l=n(0),u=n(8);function d(e,t){for(e=w(e),t=w(t);;){for(var n=[],r=0;r<t;r++)n.push(new Array(e).fill(0));for(var i=[],a=0,o=w(Math.max(Math.floor(Math.min(e/4,t/4)),3));o>=3;o-=2)for(var h=Math.pow(2,a++),s=0;s<h;s++)i.push(o);for(var c=[],f=e*t/2,l=0;l<f;){var u=m(i),d={width:u,height:u};Math.random()>.3&&(Math.random()<.5?d.width+=2:d.height+=2),c.push(d),l+=d.width*d.height}p(c);for(var y=c.length,x=0;x<y;x++){for(var M=c[x],F=!1,b=0;b<1e3;b++){M.x=w(v(1,e-M.width-1)),M.y=w(v(1,t-M.height-1));for(var A=!1,K=0;K<x;K++)if(g(M,c[K],M.width>=7?3:1,M.height>=7?3:1)){A=!0;break}if(!A){F=!0;break}}F||(delete M.x,delete M.y)}y=(c=c.filter((function(e){return e.x||e.y}))).length;for(var j=0;j<y;j++)for(var z=c[j],E=0;E<z.height;E++)for(var O=0;O<z.width;O++)n[z.y+E][z.x+O]=j+1;for(var D=[],R=0;R<=y;R++)D.push(R);for(var S=[],C=1;C<t-1;C++)for(var L=1;L<e-1;L++)0===n[C][L]&&(0===n[C-1][L]&&0===n[C+1][L]&&0!==n[C][L-1]&&0!==n[C][L+1]?n[C][L-1]<n[C][L+1]?S.push({x:L,y:C,r1:n[C][L-1],r2:n[C][L+1]}):n[C][L-1]>n[C][L+1]&&S.push({x:L,y:C,r1:n[C][L+1],r2:n[C][L-1]}):0===n[C][L-1]&&0===n[C][L+1]&&0!==n[C-1][L]&&0!==n[C+1][L]&&(n[C-1][L]<n[C+1][L]?S.push({x:L,y:C,r1:n[C-1][L],r2:n[C+1][L]}):n[C-1][L]>n[C+1][L]&&S.push({x:L,y:C,r1:n[C+1][L],r2:n[C-1][L]})));k(S);var U=S.length,_=void 0,B=void 0;for(_=0;_<U;_=B){for(B=_+1;B<U&&(S[B].r1===S[_].r1&&S[B].r2===S[_].r2);B++);if(D[S[_].r1]!==D[S[_].r2]){var P=S[Math.floor(_+(B-_)/2)],V=Math.min(D[P.r1],D[P.r2]),W=Math.max(D[P.r1],D[P.r2]);D[P.r1]=V,D[P.r2]=V;for(var q=1;q<=y;q++)D[q]===W&&(D[q]=V);n[P.y][P.x]=y+1}}for(var I=!1,J=1;J<=y;J++)if(1!==D[J]){I=!0;break}if(!I)return{width:e,height:t,data:n,rooms:c}}}function y(e){for(var t=0;t<e.height;t++)for(var n=0;n<e.width;n++)if(0!==e.data[t][n])return{x:n,y:t}}function v(e,t){return Math.floor(Math.random()*(t-e+1))+e}function w(e){return 2*Math.floor(e/2)+1}function m(e){return e[Math.floor(Math.random()*e.length)]}function p(e){e.sort((function(e,t){var n=e.width*e.height,r=t.width*t.height;return n<r?1:n>r?-1:0}))}function k(e){e.sort((function(e,t){return e.r1<t.r1?-1:e.r1>t.r1?1:e.r2<t.r2?-1:e.r2>t.r2?1:e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}))}function g(e,t,n,r){return!(e.x>=t.x+t.width+n||t.x>=e.x+e.width+n)&&!(e.y>=t.y+t.height+r||t.y>=e.y+e.height+r)}var x=function(e){function t(e){var n;Object(h.a)(this,t),(n=Object(c.a)(this,Object(f.a)(t).call(this,e))).onResize=n.onResize.bind(Object(l.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(l.a)(n)),n.onKeyUp=n.onKeyUp.bind(Object(l.a)(n)),n.onAnimationFrame=n.onAnimationFrame.bind(Object(l.a)(n)),n.onClick=n.onClick.bind(Object(l.a)(n));var r=d(101,53),i=y(r);return n.state={map:r,player:i},n.keys={},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this._resizeViewport(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){this._resizeViewport()}},{key:"onKeyDown",value:function(e){e.preventDefault(),this.keys[e.key]||(this.onKeyPress(e.key),this.keys[e.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(e){e.preventDefault(),this.keys[e.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(e){var t=this.state,n=t.map,r=t.player,i=0,a=0;"ArrowUp"===e?a=-1:"ArrowDown"===e?a=1:"ArrowLeft"===e?i=-1:"ArrowRight"===e&&(i=1),0===i&&0===a||0!==n.data[r.y+a][r.x+i]&&this.setState({player:{x:r.x+i,y:r.y+a}})}},{key:"onAnimationFrame",value:function(){this._drawMap(),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClick",value:function(){this._updateMap()}},{key:"_resizeViewport",value:function(){var e=this.canvas,t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}},{key:"_updateMap",value:function(){var e=d(101,53),t=y(e);this.setState({map:e,player:t})}},{key:"_drawMap",value:function(){var e=this.state.map,t=e.width,n=e.height,r=e.data,i=this.state.player,a=this.canvas.getContext("2d");a.fillStyle="#FFFFFF",a.fillRect(0,0,this.canvas.width,this.canvas.height);for(var o=Math.floor(this.canvas.width/t),h=Math.floor(this.canvas.height/n),s=Math.floor((this.canvas.width-t*o)/2),c=Math.floor((this.canvas.height-n*h)/2),f=0;f<n;f++)for(var l=0;l<t;l++)0!==r[f][l]&&(a.fillStyle="#000000",a.fillRect(s+l*o+1,c+f*h+1,o-2,h-2),a.fillStyle="#FFFFFF",a.font="8px monospace",a.textAlign="center",a.textBaseline="middle",a.fillText(r[f][l].toString(),s+l*o+o/2,c+f*h+h/2));a.fillStyle="#7F7FFF",a.beginPath(),a.arc(s+i.x*o+o/2,c+i.y*h+h/2,Math.min(o/4,h/4)-1,0,2*Math.PI),a.fill()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{id:"screen"},i.a.createElement("canvas",{id:"canvas",ref:function(t){return e.canvas=t},onClick:this.onClick}))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.17c60424.chunk.js.map