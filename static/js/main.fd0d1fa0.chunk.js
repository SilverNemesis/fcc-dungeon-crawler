(this["webpackJsonpfcc-dungeon-crawler"]=this["webpackJsonpfcc-dungeon-crawler"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(3),i=n.n(r),h=(n(14),n(4)),l=n(5),s=n(7),c=n(6),u=n(1),f=n(8),m=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},t.description)},d=function(e){for(var t=e.control,n=[],a=0;a<t.options.length;a++)n.push(o.a.createElement("option",{key:a,value:a},t.options[a]));return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name),o.a.createElement("select",{id:t.name,className:"select-css",value:t.value,onChange:function(n){e.onChange(t,n.target.value)}},n))},v=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{className:"clickable",htmlFor:t.name},o.a.createElement("input",{className:"clickable",id:t.name,type:"checkbox",checked:t.value,onChange:function(n){e.onChange(t,n.target.checked)}}),t.name))},y=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name," ",t.value),o.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:t.min,max:t.max,value:t.value,onChange:function(n){e.onChange(t,n.target.value)}}))},g=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("label",{htmlFor:t.name},t.name," ",t.value.toFixed(3)),o.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:Math.floor(1e3*t.min),max:Math.floor(1e3*t.max),value:Math.floor(1e3*t.value),onChange:function(n){e.onChange(t,n.target.value/1e3)}}))},x=function(e){var t=e.control;return o.a.createElement("div",{className:"control"},o.a.createElement("button",{onClick:function(e){t.function()}},t.name))},p=function(e){var t,n=e.show,a=e.title,r=e.onClickPrevious,i=e.onClickNext,h=e.onChange,l=e.options;return n?(l&&(t=l.map((function(e,t){switch(e.type){case"description":return o.a.createElement(m,{key:t,control:e});case"select":return o.a.createElement(d,{key:t,control:e,onChange:h});case"bool":return o.a.createElement(v,{key:t,control:e,onChange:h});case"int":return o.a.createElement(y,{key:t,control:e,onChange:h});case"float":return o.a.createElement(g,{key:t,control:e,onChange:h});case"function":return o.a.createElement(x,{key:t,control:e});default:return o.a.createElement("div",{key:t,className:"control"},e.type," is not supported")}}))),o.a.createElement("div",{id:"controls"},o.a.createElement("div",{className:"none"},o.a.createElement("span",{className:"left",onClick:r},"\u276e PREV"),o.a.createElement("span",{className:"right",onClick:i},"NEXT \u276f"),o.a.createElement("div",{className:"center title"},a)),o.a.createElement("div",null,t))):null},w=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];function k(e){for(var t=e.width,n=e.height,a=e.zones,o=e.bossRoom,r=[],i=0;i<n;i++)r.push(new Array(t).fill(0));var h={width:t,height:n,data:r};!function(e,t){var n=e.width,a=e.height,o=t.goal,r=t.minSize,i=t.maxSize;o||(o=.5);r||(r=3);i||(i=Math.max(Math.floor(Math.min(n/4,a/4)),r));for(var h=[],l=0,s=i;s>=r;s--)for(var c=Math.pow(2,l++),u=0;u<c;u++)h.push(s);var f=[],m=n*a*o,d=0;for(;d<m;){var v=M(h),y={width:v,height:v};Math.random()>.3&&(Math.random()<.5?y.width+=2:y.height+=2),f.push(y),d+=y.width*y.height}e.rooms=f}(h,e),h.rooms.sort((function(e,t){var n=e.width*e.height,a=t.width*t.height;return n<a?1:n>a?-1:0}));var l=e.maxRooms;if(a&&a>1){if(function(e,t){for(var n=e.width,a=e.height,o=[],r=0;r<t;r++)o[r]=r;!function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}}(o);for(var i=Math.floor((n-2)/t),h=Math.floor((a-2)/t),l=[],s=0;s<t;s++){var c={x:s*i+1,y:o[s]*h+1,width:i,height:h};l.push(c)}e.zones=l}(h,a),o){var s=h.rooms[0],c=h.zones[0];s.width<=c.width&&s.height<=c.height&&(s.x=Math.floor(c.x),s.y=Math.floor(c.y+(c.height-s.height)/2))}var u=function(e,t){for(var n=e.width,a=e.height,o=e.rooms,r=e.zones,i=0,h=0,l=o.length,s=0;s<l&&(!t||i!==t);s++){var c=o[s];if(!c.hasOwnProperty("x")||!c.hasOwnProperty("y")){var u=r[h].x,f=Math.min(r[h].x+r[h].width,n-c.width-1),m=r[h].y,d=Math.min(r[h].y+r[h].height,a-c.height-1);if(!(u+c.width>n-1||m+c.height>a-1)){for(var v=!1,y=0;y<100;y++){c.x=F(u,f),c.y=F(m,d);for(var g=!1,x=0;x<l;x++)if(x!==s&&o[x].hasOwnProperty("x")&&o[x].hasOwnProperty("y")&&C(c,o[x],1,1)){g=!0;break}if(!g){v=!0;break}}v?(i++,h=(h+1)%r.length):(delete c.x,delete c.y)}}}return i}(h,l);void 0!==l&&(l-=u)}else if(o){var f=h.rooms[0];f.width<=t-2&&f.height<=n-2&&(f.x=Math.floor((t-f.width)/2),f.y=Math.floor((n-f.height)/2))}return function(e,t){for(var n=e.width,a=e.height,o=e.rooms,r=0,i=o.length,h=0;h<i&&(void 0===t||r!==t);h++){var l=o[h];if(!l.hasOwnProperty("x")||!l.hasOwnProperty("y")){for(var s=!1,c=0;c<1e3;c++){l.x=F(1,n-l.width-1),l.y=F(1,a-l.height-1);for(var u=!1,f=0;f<i;f++)if(f!==h&&o[f].hasOwnProperty("x")&&o[f].hasOwnProperty("y")&&C(l,o[f],l.width>=7?3:1,l.height>=7?3:1)){u=!0;break}if(!u){s=!0;break}}s?r++:(delete l.x,delete l.y)}}e.rooms=e.rooms.filter((function(e){return e.x||e.y})),e.rooms.length}(h,l),function(e){for(var t=e.width,n=e.height,a=e.data,o=e.rooms,r=o.length,i=0;i<r;i++){var h=o[i];h.id=i+1;for(var l=0;l<h.height;l++)for(var s=0;s<h.width;s++)a[h.y+l][h.x+s]=h.id}for(var c=[],u=0;u<=r;u++)c.push(u);for(var f=[],m=1;m<n-1;m++)for(var d=1;d<t-1;d++)0===a[m][d]&&(0===a[m-1][d]&&0===a[m+1][d]&&0!==a[m][d-1]&&0!==a[m][d+1]?a[m][d-1]<a[m][d+1]?f.push({x:d,y:m,r1:a[m][d-1],r2:a[m][d+1]}):a[m][d-1]>a[m][d+1]&&f.push({x:d,y:m,r1:a[m][d+1],r2:a[m][d-1]}):0===a[m][d-1]&&0===a[m][d+1]&&0!==a[m-1][d]&&0!==a[m+1][d]&&(a[m-1][d]<a[m+1][d]?f.push({x:d,y:m,r1:a[m-1][d],r2:a[m+1][d]}):a[m-1][d]>a[m+1][d]&&f.push({x:d,y:m,r1:a[m+1][d],r2:a[m-1][d]})));v=f,v.sort((function(e,t){return e.r1<t.r1?-1:e.r1>t.r1?1:e.r2<t.r2?-1:e.r2>t.r2?1:e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0}));var v;var y,g,x=f.length;for(y=0;y<x;y=g){for(g=y+1;g<x&&(f[g].r1===f[y].r1&&f[g].r2===f[y].r2);g++);if(c[f[y].r1]!==c[f[y].r2]){var p=f[Math.floor(y+(g-y)/2)],w=Math.min(c[p.r1],c[p.r2]),k=Math.max(c[p.r1],c[p.r2]);c[p.r1]=w,c[p.r2]=w;for(var F=1;F<=r;F++)c[F]===k&&(c[F]=w);a[p.y][p.x]=r+1}}for(var M=0;M<r;M++){var C=o[M];C.group=c[C.id]}}(h),function(e){var t=e.data,n=e.rooms,a=n.length;!function(e){e.sort((function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.id<t.id?-1:e.id>t.id?1:0}))}(n);var o,r,i=0;for(o=0;o<a;o=r){for(r=o+1;r<a&&n[r].group===n[o].group;r++);i++;for(var h=o;h<r;h++)n[h].group=i}for(var l={},s=0;s<a;s++)for(var c=s+1;c<a;c++)if(n[s].group!==n[c].group){var u=E(n[s],n[c]);if(u){var f=u.alignment,m=u.distance,d=u.x,v=u.y,y=u.horizontal;if(0!==f){var g=n[s].group,x=n[c].group,p=g+"_"+x;l[p]?(l[p].distance>m||l[p].distance===m&&l[p].alignment<u)&&(l[p]={distance:m,g1:g,g2:x,room1:n[s].id,room2:n[c].id,alignment:f,x:d,y:v,horizontal:y}):l[p]={distance:m,g1:g,g2:x,room1:n[s].id,room2:n[c].id,alignment:f,x:d,y:v,horizontal:y}}}}var w=[];for(var k in l)l.hasOwnProperty(k)&&w.push(l[k]);F=w,F.sort((function(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:e.alignment<t.alignment?-1:e.alignment>t.alignment?1:0}));var F;for(var M=[],C=0;C<=i;C++)M.push(C);for(var b=0;b<w.length;b++){var O=w[b];if(M[O.g1]!==M[O.g2]){var N=Math.min(M[O.g1],M[O.g2]),z=Math.max(M[O.g1],M[O.g2]);M[O.g1]=N,M[O.g2]=N;for(var S=1;S<=i;S++)M[S]===z&&(M[S]=N);var P=O.x,A=O.y,K=O.distance;if(O.horizontal)for(var j=0;j<K;j++)t[A][P+j]=a+1;else for(var R=0;R<K;R++)t[A+R][P]=a+1}}e.connected=!0;for(var D=1;D<=i;D++)if(1!==M[D]){e.connected=!1;break}}(h),function(e){e.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}))}(h.rooms),h}function F(e,t){return Math.floor(Math.random()*(t-e+1))+e}function M(e){return e[Math.floor(Math.random()*e.length)]}function C(e,t,n,a){return!(e.x>=t.x+t.width+n||t.x>=e.x+e.width+n)&&!(e.y>=t.y+t.height+a||t.y>=e.y+e.height+a)}function E(e,t){if(e.y>t.y+t.height||t.y>e.y+e.height){if(e.x>t.x+t.width||t.x>e.x+e.width)return null;var n,a;e.y>t.y+t.height?(n=t.y+t.height,a=e.y-n):(n=e.y+e.height,a=t.y-n);var o=Math.min(e.x+e.width,t.x+t.width),r=Math.max(e.x,t.x);return{alignment:o-r,distance:a,x:Math.floor((r+o)/2),y:n,horizontal:!1}}if(e.x>t.x+t.width||t.x>e.x+e.width){var i,h;e.x>t.x+t.width?(i=t.x+t.width,h=e.x-i):(i=e.x+e.width,h=t.x-i);var l=Math.min(e.y+e.height,t.y+t.height),s=Math.max(e.y,t.y);return{alignment:l-s,distance:h,x:i,y:Math.floor((s+l)/2),horizontal:!0}}return null}function b(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}var O=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(s.a)(this,Object(c.a)(t).call(this,e))).onResize=n.onResize.bind(Object(u.a)(n)),n.onKeyDown=n.onKeyDown.bind(Object(u.a)(n)),n.onKeyUp=n.onKeyUp.bind(Object(u.a)(n)),n.onAnimationFrame=n.onAnimationFrame.bind(Object(u.a)(n)),n.onClickPrevious=n.onClickPrevious.bind(Object(u.a)(n)),n.onClickNext=n.onClickNext.bind(Object(u.a)(n)),n.onChange=n.onChange.bind(Object(u.a)(n)),n.updateMap=n.updateMap.bind(Object(u.a)(n)),n.keys={},n.state={showControls:!1,mode:0,modes:["Map Mode","Explore Mode"],options:[[{name:"Update Map",type:"function",function:n.updateMap}],[]]},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){b(this.canvas),this.updateMap(),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),window.cancelAnimationFrame(this.frame)}},{key:"onResize",value:function(){b(this.canvas)}},{key:"onKeyDown",value:function(e){e.preventDefault(),this.keys[e.key]||(this.onKeyPress(e.key),this.keys[e.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(e){e.preventDefault(),this.keys[e.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(e){var t=this.state,n=t.map,a=t.player;"Escape"===e&&this.setState({showControls:!this.state.showControls});var o=0,r=0;"ArrowUp"===e?r=-1:"ArrowDown"===e?r=1:"ArrowLeft"===e?o=-1:"ArrowRight"===e&&(o=1),0===o&&0===r||0!==n.data[a.y+r][a.x+o]&&this.setState({player:{x:a.x+o,y:a.y+r}})}},{key:"onCloseMenu",value:function(){this.setState({showControls:!1})}},{key:"onAnimationFrame",value:function(){this.state&&this.state.map&&function(e,t,n){var a=t.width,o=t.height,r=t.data,i=t.rooms,h=e.getContext("2d");h.fillStyle="#000000",h.fillRect(0,0,e.width,e.height);for(var l=Math.floor(e.width/a),s=Math.floor(e.height/o),c=Math.floor((e.width-a*l)/2),u=Math.floor((e.height-o*s)/2),f=["#7F0000","#007F00","#00007F","#7F7F00","#7F007F","#007F7F","#7F3F3F","#3F7F3F","#3F3F7F","#7F7F3F","#7F3F7F","#3F7F7F"],m=0;m<o;m++)for(var d=0;d<a;d++)if(0!==r[m][d]){if(r[m][d]<=i.length){var v=i[r[m][d]-1];v.group?h.fillStyle=f[(v.group-1)%f.length]:h.fillStyle="#3F3F3F"}else h.fillStyle="#3F3F3F";h.fillRect(c+d*l+1,u+m*s+1,l-2,s-2),h.fillStyle="#FFFFFF",h.font="8px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText(r[m][d].toString(),c+d*l+l/2,u+m*s+s/2)}var y=Math.floor(i[0].x+i[0].width/2),g=Math.floor(i[0].y+i[0].height/2);h.fillStyle="#FFFFFF",h.font="50px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText("O",c+y*l+l/2,u+g*s+s/2),h.fillStyle="#FFFFFF",h.font="50px monospace",h.textAlign="center",h.textBaseline="middle",h.fillText("X",c+n.x*l+l/2,u+n.y*s+s/2)}(this.canvas,this.state.map,this.state.player),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"onClickNext",value:function(){this.setState({mode:(this.state.mode+1)%this.state.modes.length})}},{key:"onClickPrevious",value:function(){this.setState({mode:(this.state.mode+this.state.modes.length-1)%this.state.modes.length})}},{key:"onChange",value:function(e,t){t!==e.value&&(this.setOption(e,t),this.forceUpdate())}},{key:"setOption",value:function(e,t){}},{key:"updateMap",value:function(){var e=k({width:112,height:63,goal:.25,zones:20,minSize:4,maxSize:10}),t=function(e){for(var t=e.width,n=e.height,a=e.data,o=[],r=0;r<n;r++)o.push(new Array(t).fill(0));if(0===e.rooms.length)return{x:1,y:1};var i=e.rooms[0],h=Math.floor(i.x+i.width/2),l=Math.floor(i.y+i.height/2),s=1,c=[];for(c.push({x:h,y:l});c.length>0;)for(var u=c.length,f=0;f<u;f++){var m=c.shift();s=a[m.y][m.x];for(var d=0;d<4;d++){var v=w[d];m.x+v.x<0||m.x+v.x>t-1||m.y+v.y<0||m.y+v.y>n-1||0!==a[m.y+v.y][m.x+v.x]&&0===o[m.y+v.y][m.x+v.x]&&(o[m.y+v.y][m.x+v.x]=1,c.push({x:m.x+v.x,y:m.y+v.y}))}}var y=e.rooms[s-1];return{x:h=Math.floor(y.x+y.width/2),y:l=Math.floor(y.y+y.height/2)}}(e);this.setState({map:e,player:t})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"screen"},o.a.createElement("canvas",{id:"canvas",ref:function(t){return e.canvas=t},onClick:this.onClick}),o.a.createElement(p,{show:this.state.showControls,title:this.state.modes[this.state.mode],options:this.state.options[this.state.mode],onClickPrevious:this.onClickPrevious,onClickNext:this.onClickNext,onChange:this.onChange}))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.fd0d1fa0.chunk.js.map